2025-07-24 22:06:04,974 p=879879 u=root n=ansible | [WARNING]: Unhandled error in Python interpreter discovery for host web1: Failed to connect to the host
via ssh: amalaver@172.206.246.59: Permission denied (publickey,password).

2025-07-24 22:06:05,215 p=879879 u=root n=ansible | web1 | UNREACHABLE! => {
    "changed": false,
    "msg": "Data could not be sent to remote host \"172.206.246.59\". Make sure this host can be reached over ssh: amalaver@172.206.246.59: Permission denied (publickey,password).\r\n",
    "unreachable": true
}
2025-07-24 22:06:38,385 p=880034 u=root n=ansible | [WARNING]: Unhandled error in Python interpreter discovery for host web1: Failed to connect to the host
via ssh: amalaver@localhost: Permission denied (publickey,password).

2025-07-24 22:06:38,601 p=880034 u=root n=ansible | web1 | UNREACHABLE! => {
    "changed": false,
    "msg": "Data could not be sent to remote host \"localhost\". Make sure this host can be reached over ssh: amalaver@localhost: Permission denied (publickey,password).\r\n",
    "unreachable": true
}
2025-07-24 22:07:48,859 p=880359 u=root n=ansible | [WARNING]: Unhandled error in Python interpreter discovery for host web1: Failed to connect to the host
via ssh: amalaver@localhost: Permission denied (publickey,password).

2025-07-24 22:07:49,076 p=880359 u=root n=ansible | web1 | UNREACHABLE! => {
    "changed": false,
    "msg": "Data could not be sent to remote host \"localhost\". Make sure this host can be reached over ssh: amalaver@localhost: Permission denied (publickey,password).\r\n",
    "unreachable": true
}
2025-07-26 13:32:47,165 p=1412637 u=root n=ansible | [WARNING]: Unhandled error in Python interpreter discovery for host web1: Failed to connect to the host via ssh: amalaver@52.188.81.6: Permission denied
(publickey).

2025-07-26 13:32:47,388 p=1412637 u=root n=ansible | web1 | UNREACHABLE! => {
    "changed": false,
    "msg": "Data could not be sent to remote host \"52.188.81.6\". Make sure this host can be reached over ssh: amalaver@52.188.81.6: Permission denied (publickey).\r\n",
    "unreachable": true
}
2025-07-26 13:37:10,045 p=1413607 u=root n=ansible | [WARNING]: Unhandled error in Python interpreter discovery for host web1: Failed to connect to the host via ssh: amalaver@52.188.81.6: Permission denied
(publickey).

2025-07-26 13:37:10,265 p=1413607 u=root n=ansible | web1 | UNREACHABLE! => {
    "changed": false,
    "msg": "Data could not be sent to remote host \"52.188.81.6\". Make sure this host can be reached over ssh: amalaver@52.188.81.6: Permission denied (publickey).\r\n",
    "unreachable": true
}
2025-07-26 13:37:55,604 p=1413779 u=root n=ansible | web1 | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
2025-07-26 14:52:40,459 p=1430425 u=root n=ansible | playbook: playbooks/install-nginx.yml
2025-07-26 14:52:56,812 p=1430489 u=root n=ansible | web1 | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
2025-07-26 14:53:06,504 p=1430539 u=root n=ansible | {
    "_meta": {
        "hostvars": {
            "web1": {
                "admin_email": "aldo.malaver@runittech.com",
                "admin_users": [
                    {
                        "comment": "Usuario DevOps",
                        "groups": "sudo",
                        "name": "devops",
                        "shell": "/bin/bash"
                    }
                ],
                "ansible_host": "52.188.81.6",
                "ansible_user": "amalaver",
                "company_name": "Pacifico Salud",
                "deployment_date": "{{ ansible_date_time.date }}",
                "document_root": "/var/www/html",
                "environment_name": "laboratorio",
                "firewall_enabled": true,
                "http_port": 80,
                "https_port": 443,
                "log_retention_days": 30,
                "nginx_access_log": "/var/log/nginx/access.log",
                "nginx_client_max_body_size": "10M",
                "nginx_error_log": "/var/log/nginx/error.log",
                "nginx_keepalive_timeout": 65,
                "nginx_log_level": "warn",
                "nginx_service_enabled": true,
                "nginx_service_state": "started",
                "nginx_user": "www-data",
                "nginx_version": "latest",
                "nginx_worker_connections": 1024,
                "nginx_worker_processes": 2,
                "ntp_enabled": true,
                "ntp_timezone": "{{ timezone }}",
                "server_id": 1,
                "ssh_port": 22,
                "ssl_certificate_key_path": "/etc/ssl/private/nginx.key",
                "ssl_certificate_path": "/etc/ssl/certs/nginx.crt",
                "ssl_enabled": false,
                "system_packages": [
                    "curl",
                    "wget",
                    "unzip",
                    "vim",
                    "htop",
                    "tree"
                ],
                "timezone": "America/Lima",
                "virtual_hosts": [
                    {
                        "document_root": "{{ document_root }}",
                        "index_files": "index.html index.htm",
                        "name": "default",
                        "server_name": "{{ ansible_default_ipv4.address }}"
                    },
                    {
                        "document_root": "/var/www/empresa",
                        "index_files": "index.html",
                        "name": "empresa",
                        "server_name": "empresa.local"
                    }
                ],
                "website_title": "Servidor Nginx - {{ environment_name }}"
            }
        }
    },
    "all": {
        "children": [
            "ungrouped",
            "webservers",
            "testing"
        ]
    },
    "testing": {
        "hosts": [
            "web1"
        ]
    },
    "webservers": {
        "hosts": [
            "web1"
        ]
    }
}
2025-07-26 14:53:38,966 p=1430693 u=root n=ansible | {
    "admin_email": "aldo.malaver@runittech.com",
    "admin_users": [
        {
            "comment": "Usuario DevOps",
            "groups": "sudo",
            "name": "devops",
            "shell": "/bin/bash"
        }
    ],
    "ansible_host": "52.188.81.6",
    "ansible_user": "amalaver",
    "company_name": "Pacifico Salud",
    "deployment_date": "{{ ansible_date_time.date }}",
    "document_root": "/var/www/html",
    "environment_name": "laboratorio",
    "firewall_enabled": true,
    "http_port": 80,
    "https_port": 443,
    "log_retention_days": 30,
    "nginx_access_log": "/var/log/nginx/access.log",
    "nginx_client_max_body_size": "10M",
    "nginx_error_log": "/var/log/nginx/error.log",
    "nginx_keepalive_timeout": 65,
    "nginx_log_level": "warn",
    "nginx_service_enabled": true,
    "nginx_service_state": "started",
    "nginx_user": "www-data",
    "nginx_version": "latest",
    "nginx_worker_connections": 1024,
    "nginx_worker_processes": 2,
    "ntp_enabled": true,
    "ntp_timezone": "{{ timezone }}",
    "server_id": 1,
    "ssh_port": 22,
    "ssl_certificate_key_path": "/etc/ssl/private/nginx.key",
    "ssl_certificate_path": "/etc/ssl/certs/nginx.crt",
    "ssl_enabled": false,
    "system_packages": [
        "curl",
        "wget",
        "unzip",
        "vim",
        "htop",
        "tree"
    ],
    "timezone": "America/Lima",
    "virtual_hosts": [
        {
            "document_root": "{{ document_root }}",
            "index_files": "index.html index.htm",
            "name": "default",
            "server_name": "{{ ansible_default_ipv4.address }}"
        },
        {
            "document_root": "/var/www/empresa",
            "index_files": "index.html",
            "name": "empresa",
            "server_name": "empresa.local"
        }
    ],
    "website_title": "Servidor Nginx - {{ environment_name }}"
}
2025-07-26 14:53:58,959 p=1430777 u=root n=ansible | PLAY [INSTALACIÓN: Nginx y dependencias del sistema] **********************************************************************************
2025-07-26 14:53:58,967 p=1430777 u=root n=ansible | TASK [Gathering Facts] ****************************************************************************************************************
2025-07-26 14:54:00,775 p=1430777 u=root n=ansible | ok: [web1]
2025-07-26 14:54:00,790 p=1430777 u=root n=ansible | TASK [Reporte: Mostrar resumen final] *************************************************************************************************
2025-07-26 14:54:00,841 p=1430777 u=root n=ansible | ok: [web1] => {
    "msg": "=====================================\nLABORATORIO COMPLETADO\n=====================================\nInstalación: EXITOSA\nConfiguración: EXITOSA  \nVerificación: EXITOSA\n\nServidores configurados: 1\nURLs disponibles:\n- http://10.0.0.5\n\nPróximos pasos:\n1. Acceder a las URLs para verificar\n2. Revisar logs en /var/log/nginx/\n3. Experimentar con configuraciones\n=====================================\n"
}
2025-07-26 14:54:00,871 p=1430777 u=root n=ansible | PLAY RECAP ****************************************************************************************************************************
2025-07-26 14:54:00,871 p=1430777 u=root n=ansible | web1                       : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-07-26 15:01:56,257 p=1432784 u=root n=ansible | ERROR! the playbook: playbooks/site.yml could not be found
2025-07-26 15:02:28,751 p=1432919 u=root n=ansible | PLAY [PLAYBOOK PRINCIPAL: Instalar y Configurar Nginx] ********************************************************************************
2025-07-26 15:02:28,759 p=1432919 u=root n=ansible | TASK [Gathering Facts] ****************************************************************************************************************
2025-07-26 15:02:30,590 p=1432919 u=root n=ansible | ok: [web1]
2025-07-26 15:02:30,598 p=1432919 u=root n=ansible | TASK [Verificar conectividad a los hosts] *********************************************************************************************
2025-07-26 15:02:30,948 p=1432919 u=root n=ansible | ok: [web1]
2025-07-26 15:02:30,964 p=1432919 u=root n=ansible | TASK [Incluir playbook de instalación] ************************************************************************************************
2025-07-26 15:02:30,985 p=1432919 u=root n=ansible | ERROR! conflicting action statements: hosts, gather_facts

The error appears to be in '/opt/nginx-lab/playbooks/install-nginx.yml': line 1, column 3, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


- name: "INSTALACIÓN: Nginx y dependencias del sistema"
  ^ here
This one looks easy to fix. It seems that there is a value started
with a quote, and the YAML parser is expecting to see the line ended
with the same kind of quote. For instance:

    when: "ok" in result.stdout

Could be written as:

   when: '"ok" in result.stdout'

Or equivalently:

   when: "'ok' in result.stdout"

2025-07-26 15:17:04,040 p=1436443 u=root n=ansible | PLAY [LABORATORIO: Instalación y configuración completa de Nginx] *********************************************************************
2025-07-26 15:17:04,049 p=1436443 u=root n=ansible | TASK [Gathering Facts] ****************************************************************************************************************
2025-07-26 15:17:05,840 p=1436443 u=root n=ansible | ok: [web1]
2025-07-26 15:17:05,846 p=1436443 u=root n=ansible | TASK [Preparación: Mostrar información inicial] ***************************************************************************************
2025-07-26 15:17:05,867 p=1436443 u=root n=ansible | ok: [web1] => {
    "msg": "=====================================\nINICIO DEL LABORATORIO NGINX\n=====================================\nHost: vamalaver01\nIP: 10.0.0.5\nSistema: Ubuntu 24.04\nEntorno: laboratorio\n=====================================\n"
}
2025-07-26 15:17:05,874 p=1436443 u=root n=ansible | TASK [Preparación: Actualizar cache de paquetes] **************************************************************************************
2025-07-26 15:17:06,879 p=1436443 u=root n=ansible | changed: [web1]
2025-07-26 15:17:06,895 p=1436443 u=root n=ansible | ERROR! [DEPRECATED]: ansible.builtin.include has been removed. Use include_tasks or import_tasks instead. This feature was removed from ansible-core in a release after 2023-05-16. Please update your playbooks.
2025-07-26 15:18:27,689 p=1436794 u=root n=ansible | ERROR! conflicting action statements: hosts, gather_facts

The error appears to be in '/opt/nginx-lab/playbooks/install-nginx.yml': line 1, column 3, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


- name: "INSTALACIÓN: Nginx y dependencias del sistema"
  ^ here
This one looks easy to fix. It seems that there is a value started
with a quote, and the YAML parser is expecting to see the line ended
with the same kind of quote. For instance:

    when: "ok" in result.stdout

Could be written as:

   when: '"ok" in result.stdout'

Or equivalently:

   when: "'ok' in result.stdout"

2025-07-26 15:18:30,213 p=1436797 u=root n=ansible | ERROR! conflicting action statements: hosts, gather_facts

The error appears to be in '/opt/nginx-lab/playbooks/install-nginx.yml': line 1, column 3, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


- name: "INSTALACIÓN: Nginx y dependencias del sistema"
  ^ here
This one looks easy to fix. It seems that there is a value started
with a quote, and the YAML parser is expecting to see the line ended
with the same kind of quote. For instance:

    when: "ok" in result.stdout

Could be written as:

   when: '"ok" in result.stdout'

Or equivalently:

   when: "'ok' in result.stdout"

2025-07-26 15:20:20,687 p=1437216 u=root n=ansible | ERROR! conflicting action statements: hosts, gather_facts

The error appears to be in '/opt/nginx-lab/playbooks/configure-nginx.yml': line 3, column 3, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:

# playbooks/configure-nginx.yml - Configuración de Nginx
- name: "CONFIGURACIÓN: Nginx y virtual hosts"
  ^ here
This one looks easy to fix. It seems that there is a value started
with a quote, and the YAML parser is expecting to see the line ended
with the same kind of quote. For instance:

    when: "ok" in result.stdout

Could be written as:

   when: '"ok" in result.stdout'

Or equivalently:

   when: "'ok' in result.stdout"

2025-07-26 15:21:23,635 p=1437449 u=root n=ansible | PLAY [LABORATORIO: Instalación y configuración completa de Nginx] *********************************************************************
2025-07-26 15:21:23,645 p=1437449 u=root n=ansible | TASK [Gathering Facts] ****************************************************************************************************************
2025-07-26 15:21:25,484 p=1437449 u=root n=ansible | ok: [web1]
2025-07-26 15:21:25,492 p=1437449 u=root n=ansible | TASK [Preparación: Mostrar información inicial] ***************************************************************************************
2025-07-26 15:21:25,516 p=1437449 u=root n=ansible | ok: [web1] => {
    "msg": "=====================================\nINICIO DEL LABORATORIO NGINX\n=====================================\nHost: vamalaver01\nIP: 10.0.0.5\nSistema: Ubuntu 24.04\nEntorno: laboratorio\n=====================================\n"
}
2025-07-26 15:21:25,526 p=1437449 u=root n=ansible | TASK [Preparación: Actualizar cache de paquetes] **************************************************************************************
2025-07-26 15:21:26,537 p=1437449 u=root n=ansible | changed: [web1]
2025-07-26 15:21:26,554 p=1437449 u=root n=ansible | TASK [Sistema: Configurar timezone] ***************************************************************************************************
2025-07-26 15:21:26,577 p=1437449 u=root n=ansible | skipping: [web1]
2025-07-26 15:21:26,585 p=1437449 u=root n=ansible | TASK [Sistema: Instalar paquetes del sistema] *****************************************************************************************
2025-07-26 15:21:26,602 p=1437449 u=root n=ansible | fatal: [web1]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'system_packages' is undefined. 'system_packages' is undefined\n\nThe error appears to be in '/opt/nginx-lab/playbooks/install-nginx.yml': line 11, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n- name: \"Sistema: Instalar paquetes del sistema\"\n  ^ here\nThis one looks easy to fix. It seems that there is a value started\nwith a quote, and the YAML parser is expecting to see the line ended\nwith the same kind of quote. For instance:\n\n    when: \"ok\" in result.stdout\n\nCould be written as:\n\n   when: '\"ok\" in result.stdout'\n\nOr equivalently:\n\n   when: \"'ok' in result.stdout\"\n"}
2025-07-26 15:21:26,603 p=1437449 u=root n=ansible | PLAY RECAP ****************************************************************************************************************************
2025-07-26 15:21:26,604 p=1437449 u=root n=ansible | web1                       : ok=3    changed=1    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2025-07-26 15:23:23,554 p=1437931 u=root n=ansible | PLAY [LABORATORIO: Instalación y configuración completa de Nginx] *********************************************************************
2025-07-26 15:23:23,564 p=1437931 u=root n=ansible | TASK [Gathering Facts] ****************************************************************************************************************
2025-07-26 15:23:25,377 p=1437931 u=root n=ansible | ok: [web1]
2025-07-26 15:23:25,384 p=1437931 u=root n=ansible | TASK [Preparación: Mostrar información inicial] ***************************************************************************************
2025-07-26 15:23:25,408 p=1437931 u=root n=ansible | ok: [web1] => {
    "msg": "=====================================\nINICIO DEL LABORATORIO NGINX\n=====================================\nHost: vamalaver01\nIP: 10.0.0.5\nSistema: Ubuntu 24.04\nEntorno: laboratorio\n=====================================\n"
}
2025-07-26 15:23:25,416 p=1437931 u=root n=ansible | TASK [Preparación: Actualizar cache de paquetes] **************************************************************************************
2025-07-26 15:23:26,419 p=1437931 u=root n=ansible | changed: [web1]
2025-07-26 15:23:26,435 p=1437931 u=root n=ansible | TASK [Sistema: Configurar timezone] ***************************************************************************************************
2025-07-26 15:23:26,460 p=1437931 u=root n=ansible | skipping: [web1]
2025-07-26 15:23:26,466 p=1437931 u=root n=ansible | TASK [Sistema: Instalar paquetes del sistema] *****************************************************************************************
2025-07-26 15:23:26,486 p=1437931 u=root n=ansible | fatal: [web1]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'system_packages' is undefined. 'system_packages' is undefined\n\nThe error appears to be in '/opt/nginx-lab/playbooks/install-nginx.yml': line 11, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n- name: \"Sistema: Instalar paquetes del sistema\"\n  ^ here\nThis one looks easy to fix. It seems that there is a value started\nwith a quote, and the YAML parser is expecting to see the line ended\nwith the same kind of quote. For instance:\n\n    when: \"ok\" in result.stdout\n\nCould be written as:\n\n   when: '\"ok\" in result.stdout'\n\nOr equivalently:\n\n   when: \"'ok' in result.stdout\"\n"}
2025-07-26 15:23:26,487 p=1437931 u=root n=ansible | PLAY RECAP ****************************************************************************************************************************
2025-07-26 15:23:26,488 p=1437931 u=root n=ansible | web1                       : ok=3    changed=1    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2025-07-26 15:25:36,533 p=1438453 u=root n=ansible | PLAY [LABORATORIO: Instalación y configuración completa de Nginx] *********************************************************************
2025-07-26 15:25:36,543 p=1438453 u=root n=ansible | TASK [Gathering Facts] ****************************************************************************************************************
2025-07-26 15:25:38,352 p=1438453 u=root n=ansible | ok: [web1]
2025-07-26 15:25:38,361 p=1438453 u=root n=ansible | TASK [Preparación: Mostrar información inicial] ***************************************************************************************
2025-07-26 15:25:38,382 p=1438453 u=root n=ansible | ok: [web1] => {
    "msg": "=====================================\nINICIO DEL LABORATORIO NGINX\n=====================================\nHost: vamalaver01\nIP: 10.0.0.5\nSistema: Ubuntu 24.04\nEntorno: laboratorio\n=====================================\n"
}
2025-07-26 15:25:38,388 p=1438453 u=root n=ansible | TASK [Preparación: Actualizar cache de paquetes] **************************************************************************************
2025-07-26 15:25:39,382 p=1438453 u=root n=ansible | changed: [web1]
2025-07-26 15:25:39,399 p=1438453 u=root n=ansible | TASK [Debug: Verificar variables cargadas] ********************************************************************************************
2025-07-26 15:25:39,445 p=1438453 u=root n=ansible | ok: [web1] => {
    "msg": "Variables del sistema:\n- system_packages: ['curl', 'wget', 'unzip', 'vim', 'htop', 'tree']\n- environment_name: laboratorio\n- timezone: America/Lima\n"
}
2025-07-26 15:25:39,452 p=1438453 u=root n=ansible | TASK [Sistema: Configurar timezone] ***************************************************************************************************
2025-07-26 15:25:39,473 p=1438453 u=root n=ansible | skipping: [web1]
2025-07-26 15:25:39,480 p=1438453 u=root n=ansible | TASK [Sistema: Instalar paquetes del sistema] *****************************************************************************************
2025-07-26 15:25:41,029 p=1438453 u=root n=ansible | Suggested packages:
  zip
The following NEW packages will be installed:
  tree unzip
0 upgraded, 2 newly installed, 0 to remove and 33 not upgraded.
2025-07-26 15:25:41,029 p=1438453 u=root n=ansible | changed: [web1]
2025-07-26 15:25:41,036 p=1438453 u=root n=ansible | TASK [Sistema: Crear usuario administrativo] ******************************************************************************************
2025-07-26 15:25:41,516 p=1438453 u=root n=ansible | changed: [web1] => (item={'name': 'devops', 'comment': 'Usuario DevOps', 'groups': 'sudo', 'shell': '/bin/bash'})
2025-07-26 15:25:41,524 p=1438453 u=root n=ansible | TASK [Nginx: Instalar nginx] **********************************************************************************************************
2025-07-26 15:25:42,132 p=1438453 u=root n=ansible | ok: [web1]
2025-07-26 15:25:42,139 p=1438453 u=root n=ansible | TASK [Nginx: Verificar instalación] ***************************************************************************************************
2025-07-26 15:25:42,479 p=1438453 u=root n=ansible | skipping: [web1]
2025-07-26 15:25:42,486 p=1438453 u=root n=ansible | TASK [Nginx: Mostrar versión instalada] ***********************************************************************************************
2025-07-26 15:25:42,508 p=1438453 u=root n=ansible | ok: [web1] => {
    "msg": "Nginx instalado: "
}
2025-07-26 15:25:42,515 p=1438453 u=root n=ansible | TASK [Nginx: Crear directorio de backup para configuraciones] *************************************************************************
2025-07-26 15:25:42,916 p=1438453 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
     "path": "/etc/nginx/backup",
[0;31m-    "state": "absent"[0m
[0;31m[0m[0;32m+    "state": "directory"[0m
[0;32m[0m }


2025-07-26 15:25:42,917 p=1438453 u=root n=ansible | changed: [web1]
2025-07-26 15:25:42,927 p=1438453 u=root n=ansible | TASK [Nginx: Backup de configuración original] ****************************************************************************************
2025-07-26 15:25:43,343 p=1438453 u=root n=ansible | fatal: [web1]: FAILED! => {"changed": false, "msg": "Destination directory /etc/nginx/backup does not exist"}
2025-07-26 15:25:43,344 p=1438453 u=root n=ansible | PLAY RECAP ****************************************************************************************************************************
2025-07-26 15:25:43,344 p=1438453 u=root n=ansible | web1                       : ok=9    changed=4    unreachable=0    failed=1    skipped=2    rescued=0    ignored=0   
2025-07-26 15:27:42,025 p=1438972 u=root n=ansible | PLAY [LABORATORIO: Instalación y configuración completa de Nginx] *********************************************************************
2025-07-26 15:27:42,036 p=1438972 u=root n=ansible | TASK [Gathering Facts] ****************************************************************************************************************
2025-07-26 15:27:43,846 p=1438972 u=root n=ansible | ok: [web1]
2025-07-26 15:27:43,854 p=1438972 u=root n=ansible | TASK [Preparación: Mostrar información inicial] ***************************************************************************************
2025-07-26 15:27:43,875 p=1438972 u=root n=ansible | ok: [web1] => {
    "msg": "=====================================\nINICIO DEL LABORATORIO NGINX\n=====================================\nHost: vamalaver01\nIP: 10.0.0.5\nSistema: Ubuntu 24.04\nEntorno: laboratorio\n=====================================\n"
}
2025-07-26 15:27:43,881 p=1438972 u=root n=ansible | TASK [Preparación: Actualizar cache de paquetes] **************************************************************************************
2025-07-26 15:27:44,882 p=1438972 u=root n=ansible | changed: [web1]
2025-07-26 15:27:44,899 p=1438972 u=root n=ansible | TASK [Debug: Verificar variables cargadas] ********************************************************************************************
2025-07-26 15:27:44,945 p=1438972 u=root n=ansible | ok: [web1] => {
    "msg": "Variables del sistema:\n- system_packages: ['curl', 'wget', 'unzip', 'vim', 'htop', 'tree']\n- environment_name: laboratorio\n- timezone: America/Lima\n"
}
2025-07-26 15:27:44,951 p=1438972 u=root n=ansible | TASK [Sistema: Configurar timezone] ***************************************************************************************************
2025-07-26 15:27:44,974 p=1438972 u=root n=ansible | skipping: [web1]
2025-07-26 15:27:44,980 p=1438972 u=root n=ansible | TASK [Sistema: Instalar paquetes del sistema] *****************************************************************************************
2025-07-26 15:27:46,555 p=1438972 u=root n=ansible | Suggested packages:
  zip
The following NEW packages will be installed:
  tree unzip
0 upgraded, 2 newly installed, 0 to remove and 33 not upgraded.
2025-07-26 15:27:46,556 p=1438972 u=root n=ansible | changed: [web1]
2025-07-26 15:27:46,562 p=1438972 u=root n=ansible | TASK [Sistema: Crear usuario administrativo] ******************************************************************************************
2025-07-26 15:27:47,026 p=1438972 u=root n=ansible | changed: [web1] => (item={'name': 'devops', 'comment': 'Usuario DevOps', 'groups': 'sudo', 'shell': '/bin/bash'})
2025-07-26 15:27:47,033 p=1438972 u=root n=ansible | TASK [Nginx: Instalar nginx] **********************************************************************************************************
2025-07-26 15:27:47,646 p=1438972 u=root n=ansible | ok: [web1]
2025-07-26 15:27:47,653 p=1438972 u=root n=ansible | TASK [Nginx: Verificar instalación] ***************************************************************************************************
2025-07-26 15:27:48,020 p=1438972 u=root n=ansible | skipping: [web1]
2025-07-26 15:27:48,027 p=1438972 u=root n=ansible | TASK [Nginx: Mostrar versión instalada] ***********************************************************************************************
2025-07-26 15:27:48,048 p=1438972 u=root n=ansible | ok: [web1] => {
    "msg": "Nginx instalado: "
}
2025-07-26 15:27:48,054 p=1438972 u=root n=ansible | TASK [Sistema: Configurar logrotate básico] *******************************************************************************************
2025-07-26 15:27:48,662 p=1438972 u=root n=ansible | ok: [web1]
2025-07-26 15:27:48,671 p=1438972 u=root n=ansible | TASK [Red: Configurar UFW si está habilitado] *****************************************************************************************
2025-07-26 15:27:49,309 p=1438972 u=root n=ansible | ok: [web1]
2025-07-26 15:27:49,316 p=1438972 u=root n=ansible | TASK [Verificación: Estado del servicio nginx] ****************************************************************************************
2025-07-26 15:27:50,066 p=1438972 u=root n=ansible | ok: [web1]
2025-07-26 15:27:50,073 p=1438972 u=root n=ansible | TASK [Verificación: Comprobar que nginx está escuchando] ******************************************************************************
2025-07-26 15:27:50,461 p=1438972 u=root n=ansible | skipping: [web1]
2025-07-26 15:27:50,468 p=1438972 u=root n=ansible | TASK [Info: Mostrar resumen de instalación] *******************************************************************************************
2025-07-26 15:27:50,490 p=1438972 u=root n=ansible | ok: [web1] => {
    "msg": "=====================================\nINSTALACIÓN COMPLETADA\n=====================================\nHost: vamalaver01\nNginx Version: \nEstado: Instalado y funcionando\nPuerto: 80 activo\nPróximo paso: Configuración\n=====================================\n"
}
2025-07-26 15:27:50,496 p=1438972 u=root n=ansible | TASK [Config: Crear directorios para virtual hosts] ***********************************************************************************
2025-07-26 15:27:50,869 p=1438972 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,5 +1,5 @@[0m
[0;36m[0m {
[0;31m-    "group": 0,[0m
[0;31m[0m[0;31m-    "owner": 0,[0m
[0;31m[0m[0;32m+    "group": 33,[0m
[0;32m[0m[0;32m+    "owner": 33,[0m
[0;32m[0m     "path": "/etc/nginx/sites-available"
 }


2025-07-26 15:27:50,870 p=1438972 u=root n=ansible | changed: [web1] => (item=/etc/nginx/sites-available)
2025-07-26 15:27:51,090 p=1438972 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,5 +1,5 @@[0m
[0;36m[0m {
[0;31m-    "group": 0,[0m
[0;31m[0m[0;31m-    "owner": 0,[0m
[0;31m[0m[0;32m+    "group": 33,[0m
[0;32m[0m[0;32m+    "owner": 33,[0m
[0;32m[0m     "path": "/etc/nginx/sites-enabled"
 }


2025-07-26 15:27:51,091 p=1438972 u=root n=ansible | changed: [web1] => (item=/etc/nginx/sites-enabled)
2025-07-26 15:27:51,312 p=1438972 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,5 +1,5 @@[0m
[0;36m[0m {
[0;31m-    "group": 0,[0m
[0;31m[0m[0;31m-    "owner": 0,[0m
[0;31m[0m[0;32m+    "group": 33,[0m
[0;32m[0m[0;32m+    "owner": 33,[0m
[0;32m[0m     "path": "/etc/nginx/conf.d"
 }


2025-07-26 15:27:51,313 p=1438972 u=root n=ansible | changed: [web1] => (item=/etc/nginx/conf.d)
2025-07-26 15:27:51,323 p=1438972 u=root n=ansible | TASK [Config: Crear directorios de documentos web] ************************************************************************************
2025-07-26 15:27:51,592 p=1438972 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,5 +1,5 @@[0m
[0;36m[0m {
[0;31m-    "group": 0,[0m
[0;31m[0m[0;31m-    "owner": 0,[0m
[0;31m[0m[0;32m+    "group": 33,[0m
[0;32m[0m[0;32m+    "owner": 33,[0m
[0;32m[0m     "path": "/var/www/html"
 }


2025-07-26 15:27:51,594 p=1438972 u=root n=ansible | changed: [web1] => (item={'name': 'default', 'server_name': '10.0.0.5', 'document_root': '/var/www/html', 'index_files': 'index.html index.htm'})
2025-07-26 15:27:51,826 p=1438972 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
     "path": "/var/www/empresa",
[0;31m-    "state": "absent"[0m
[0;31m[0m[0;32m+    "state": "directory"[0m
[0;32m[0m }


2025-07-26 15:27:51,827 p=1438972 u=root n=ansible | changed: [web1] => (item={'name': 'empresa', 'server_name': 'empresa.local', 'document_root': '/var/www/empresa', 'index_files': 'index.html'})
2025-07-26 15:27:51,835 p=1438972 u=root n=ansible | TASK [Config: Desplegar configuración principal de nginx] *****************************************************************************
2025-07-26 15:27:51,909 p=1438972 u=root n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: If you are using a module and expect the file to exist on the remote, see the remote_src option
2025-07-26 15:27:51,909 p=1438972 u=root n=ansible | fatal: [web1]: FAILED! => {"changed": false, "msg": "Could not find or access 'nginx.conf.j2'\nSearched in:\n\t/opt/nginx-lab/playbooks/templates/nginx.conf.j2\n\t/opt/nginx-lab/playbooks/nginx.conf.j2\n\t/opt/nginx-lab/playbooks/templates/nginx.conf.j2\n\t/opt/nginx-lab/playbooks/nginx.conf.j2 on the Ansible Controller.\nIf you are using a module and expect the file to exist on the remote, see the remote_src option"}
2025-07-26 15:27:51,910 p=1438972 u=root n=ansible | PLAY RECAP ****************************************************************************************************************************
2025-07-26 15:27:51,910 p=1438972 u=root n=ansible | web1                       : ok=14   changed=5    unreachable=0    failed=1    skipped=3    rescued=0    ignored=0   
2025-07-26 15:31:48,457 p=1439948 u=root n=ansible | PLAY [LABORATORIO: Instalación y configuración completa de Nginx] **********************************************************************************************************
2025-07-26 15:31:48,468 p=1439948 u=root n=ansible | TASK [Gathering Facts] *****************************************************************************************************************************************************
2025-07-26 15:31:50,284 p=1439948 u=root n=ansible | ok: [web1]
2025-07-26 15:31:50,291 p=1439948 u=root n=ansible | TASK [Preparación: Mostrar información inicial] ****************************************************************************************************************************
2025-07-26 15:31:50,314 p=1439948 u=root n=ansible | ok: [web1] => {
    "msg": "=====================================\nINICIO DEL LABORATORIO NGINX\n=====================================\nHost: vamalaver01\nIP: 10.0.0.5\nSistema: Ubuntu 24.04\nEntorno: laboratorio\n=====================================\n"
}
2025-07-26 15:31:50,320 p=1439948 u=root n=ansible | TASK [Preparación: Actualizar cache de paquetes] ***************************************************************************************************************************
2025-07-26 15:31:51,327 p=1439948 u=root n=ansible | changed: [web1]
2025-07-26 15:31:51,344 p=1439948 u=root n=ansible | TASK [Debug: Verificar variables cargadas] *********************************************************************************************************************************
2025-07-26 15:31:51,390 p=1439948 u=root n=ansible | ok: [web1] => {
    "msg": "Variables del sistema:\n- system_packages: ['curl', 'wget', 'unzip', 'vim', 'htop', 'tree']\n- environment_name: laboratorio\n- timezone: America/Lima\n"
}
2025-07-26 15:31:51,397 p=1439948 u=root n=ansible | TASK [Sistema: Configurar timezone] ****************************************************************************************************************************************
2025-07-26 15:31:51,419 p=1439948 u=root n=ansible | skipping: [web1]
2025-07-26 15:31:51,426 p=1439948 u=root n=ansible | TASK [Sistema: Instalar paquetes del sistema] ******************************************************************************************************************************
2025-07-26 15:31:52,999 p=1439948 u=root n=ansible | Suggested packages:
  zip
The following NEW packages will be installed:
  tree unzip
0 upgraded, 2 newly installed, 0 to remove and 33 not upgraded.
2025-07-26 15:31:53,000 p=1439948 u=root n=ansible | changed: [web1]
2025-07-26 15:31:53,007 p=1439948 u=root n=ansible | TASK [Sistema: Crear usuario administrativo] *******************************************************************************************************************************
2025-07-26 15:31:53,473 p=1439948 u=root n=ansible | changed: [web1] => (item={'name': 'devops', 'comment': 'Usuario DevOps', 'groups': 'sudo', 'shell': '/bin/bash'})
2025-07-26 15:31:53,481 p=1439948 u=root n=ansible | TASK [Nginx: Instalar nginx] ***********************************************************************************************************************************************
2025-07-26 15:31:54,084 p=1439948 u=root n=ansible | ok: [web1]
2025-07-26 15:31:54,092 p=1439948 u=root n=ansible | TASK [Nginx: Verificar instalación] ****************************************************************************************************************************************
2025-07-26 15:31:54,438 p=1439948 u=root n=ansible | skipping: [web1]
2025-07-26 15:31:54,445 p=1439948 u=root n=ansible | TASK [Nginx: Mostrar versión instalada] ************************************************************************************************************************************
2025-07-26 15:31:54,466 p=1439948 u=root n=ansible | ok: [web1] => {
    "msg": "Nginx instalado: "
}
2025-07-26 15:31:54,473 p=1439948 u=root n=ansible | TASK [Sistema: Configurar logrotate básico] ********************************************************************************************************************************
2025-07-26 15:31:55,070 p=1439948 u=root n=ansible | ok: [web1]
2025-07-26 15:31:55,079 p=1439948 u=root n=ansible | TASK [Red: Configurar UFW si está habilitado] ******************************************************************************************************************************
2025-07-26 15:31:55,704 p=1439948 u=root n=ansible | ok: [web1]
2025-07-26 15:31:55,712 p=1439948 u=root n=ansible | TASK [Verificación: Estado del servicio nginx] *****************************************************************************************************************************
2025-07-26 15:31:56,502 p=1439948 u=root n=ansible | ok: [web1]
2025-07-26 15:31:56,509 p=1439948 u=root n=ansible | TASK [Verificación: Comprobar que nginx está escuchando] *******************************************************************************************************************
2025-07-26 15:31:56,871 p=1439948 u=root n=ansible | skipping: [web1]
2025-07-26 15:31:56,878 p=1439948 u=root n=ansible | TASK [Info: Mostrar resumen de instalación] ********************************************************************************************************************************
2025-07-26 15:31:56,900 p=1439948 u=root n=ansible | ok: [web1] => {
    "msg": "=====================================\nINSTALACIÓN COMPLETADA\n=====================================\nHost: vamalaver01\nNginx Version: \nEstado: Instalado y funcionando\nPuerto: 80 activo\nPróximo paso: Configuración\n=====================================\n"
}
2025-07-26 15:31:56,906 p=1439948 u=root n=ansible | TASK [Config: Crear directorios para virtual hosts] ************************************************************************************************************************
2025-07-26 15:31:57,286 p=1439948 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,5 +1,5 @@[0m
[0;36m[0m {
[0;31m-    "group": 0,[0m
[0;31m[0m[0;31m-    "owner": 0,[0m
[0;31m[0m[0;32m+    "group": 33,[0m
[0;32m[0m[0;32m+    "owner": 33,[0m
[0;32m[0m     "path": "/etc/nginx/sites-available"
 }


2025-07-26 15:31:57,287 p=1439948 u=root n=ansible | changed: [web1] => (item=/etc/nginx/sites-available)
2025-07-26 15:31:57,505 p=1439948 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,5 +1,5 @@[0m
[0;36m[0m {
[0;31m-    "group": 0,[0m
[0;31m[0m[0;31m-    "owner": 0,[0m
[0;31m[0m[0;32m+    "group": 33,[0m
[0;32m[0m[0;32m+    "owner": 33,[0m
[0;32m[0m     "path": "/etc/nginx/sites-enabled"
 }


2025-07-26 15:31:57,506 p=1439948 u=root n=ansible | changed: [web1] => (item=/etc/nginx/sites-enabled)
2025-07-26 15:31:57,726 p=1439948 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,5 +1,5 @@[0m
[0;36m[0m {
[0;31m-    "group": 0,[0m
[0;31m[0m[0;31m-    "owner": 0,[0m
[0;31m[0m[0;32m+    "group": 33,[0m
[0;32m[0m[0;32m+    "owner": 33,[0m
[0;32m[0m     "path": "/etc/nginx/conf.d"
 }


2025-07-26 15:31:57,727 p=1439948 u=root n=ansible | changed: [web1] => (item=/etc/nginx/conf.d)
2025-07-26 15:31:57,736 p=1439948 u=root n=ansible | TASK [Config: Crear directorios de documentos web] *************************************************************************************************************************
2025-07-26 15:31:58,005 p=1439948 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,5 +1,5 @@[0m
[0;36m[0m {
[0;31m-    "group": 0,[0m
[0;31m[0m[0;31m-    "owner": 0,[0m
[0;31m[0m[0;32m+    "group": 33,[0m
[0;32m[0m[0;32m+    "owner": 33,[0m
[0;32m[0m     "path": "/var/www/html"
 }


2025-07-26 15:31:58,006 p=1439948 u=root n=ansible | changed: [web1] => (item={'name': 'default', 'server_name': '10.0.0.5', 'document_root': '/var/www/html', 'index_files': 'index.html index.htm'})
2025-07-26 15:31:58,226 p=1439948 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
     "path": "/var/www/empresa",
[0;31m-    "state": "absent"[0m
[0;31m[0m[0;32m+    "state": "directory"[0m
[0;32m[0m }


2025-07-26 15:31:58,227 p=1439948 u=root n=ansible | changed: [web1] => (item={'name': 'empresa', 'server_name': 'empresa.local', 'document_root': '/var/www/empresa', 'index_files': 'index.html'})
2025-07-26 15:31:58,235 p=1439948 u=root n=ansible | TASK [Config: Desplegar configuración principal de nginx] ******************************************************************************************************************
2025-07-26 15:31:58,301 p=1439948 u=root n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: If you are using a module and expect the file to exist on the remote, see the remote_src option
2025-07-26 15:31:58,302 p=1439948 u=root n=ansible | fatal: [web1]: FAILED! => {"changed": false, "msg": "Could not find or access 'nginx.conf.j2'\nSearched in:\n\t/opt/nginx-lab/playbooks/templates/nginx.conf.j2\n\t/opt/nginx-lab/playbooks/nginx.conf.j2\n\t/opt/nginx-lab/playbooks/templates/nginx.conf.j2\n\t/opt/nginx-lab/playbooks/nginx.conf.j2 on the Ansible Controller.\nIf you are using a module and expect the file to exist on the remote, see the remote_src option"}
2025-07-26 15:31:58,304 p=1439948 u=root n=ansible | PLAY RECAP *****************************************************************************************************************************************************************
2025-07-26 15:31:58,305 p=1439948 u=root n=ansible | web1                       : ok=14   changed=5    unreachable=0    failed=1    skipped=3    rescued=0    ignored=0   
2025-07-26 15:35:14,346 p=1440820 u=root n=ansible | PLAY [LABORATORIO: Instalación y configuración completa de Nginx] **********************************************************************************************************
2025-07-26 15:35:14,356 p=1440820 u=root n=ansible | TASK [Gathering Facts] *****************************************************************************************************************************************************
2025-07-26 15:35:16,187 p=1440820 u=root n=ansible | ok: [web1]
2025-07-26 15:35:16,196 p=1440820 u=root n=ansible | TASK [Preparación: Mostrar información inicial] ****************************************************************************************************************************
2025-07-26 15:35:16,217 p=1440820 u=root n=ansible | ok: [web1] => {
    "msg": "=====================================\nINICIO DEL LABORATORIO NGINX\n=====================================\nHost: vamalaver01\nIP: 10.0.0.5\nSistema: Ubuntu 24.04\nEntorno: laboratorio\n=====================================\n"
}
2025-07-26 15:35:16,223 p=1440820 u=root n=ansible | TASK [Preparación: Actualizar cache de paquetes] ***************************************************************************************************************************
2025-07-26 15:35:17,228 p=1440820 u=root n=ansible | changed: [web1]
2025-07-26 15:35:17,244 p=1440820 u=root n=ansible | TASK [Debug: Verificar variables cargadas] *********************************************************************************************************************************
2025-07-26 15:35:17,288 p=1440820 u=root n=ansible | ok: [web1] => {
    "msg": "Variables del sistema:\n- system_packages: ['curl', 'wget', 'unzip', 'vim', 'htop', 'tree']\n- environment_name: laboratorio\n- timezone: America/Lima\n"
}
2025-07-26 15:35:17,295 p=1440820 u=root n=ansible | TASK [Sistema: Configurar timezone] ****************************************************************************************************************************************
2025-07-26 15:35:17,322 p=1440820 u=root n=ansible | skipping: [web1]
2025-07-26 15:35:17,329 p=1440820 u=root n=ansible | TASK [Sistema: Instalar paquetes del sistema] ******************************************************************************************************************************
2025-07-26 15:35:18,918 p=1440820 u=root n=ansible | Suggested packages:
  zip
The following NEW packages will be installed:
  tree unzip
0 upgraded, 2 newly installed, 0 to remove and 33 not upgraded.
2025-07-26 15:35:18,919 p=1440820 u=root n=ansible | changed: [web1]
2025-07-26 15:35:18,926 p=1440820 u=root n=ansible | TASK [Sistema: Crear usuario administrativo] *******************************************************************************************************************************
2025-07-26 15:35:19,411 p=1440820 u=root n=ansible | changed: [web1] => (item={'name': 'devops', 'comment': 'Usuario DevOps', 'groups': 'sudo', 'shell': '/bin/bash'})
2025-07-26 15:35:19,419 p=1440820 u=root n=ansible | TASK [Nginx: Instalar nginx] ***********************************************************************************************************************************************
2025-07-26 15:35:20,026 p=1440820 u=root n=ansible | ok: [web1]
2025-07-26 15:35:20,033 p=1440820 u=root n=ansible | TASK [Nginx: Verificar instalación] ****************************************************************************************************************************************
2025-07-26 15:35:20,386 p=1440820 u=root n=ansible | skipping: [web1]
2025-07-26 15:35:20,394 p=1440820 u=root n=ansible | TASK [Nginx: Mostrar versión instalada] ************************************************************************************************************************************
2025-07-26 15:35:20,417 p=1440820 u=root n=ansible | ok: [web1] => {
    "msg": "Nginx instalado: "
}
2025-07-26 15:35:20,424 p=1440820 u=root n=ansible | TASK [Sistema: Configurar logrotate básico] ********************************************************************************************************************************
2025-07-26 15:35:21,030 p=1440820 u=root n=ansible | ok: [web1]
2025-07-26 15:35:21,039 p=1440820 u=root n=ansible | TASK [Red: Configurar UFW si está habilitado] ******************************************************************************************************************************
2025-07-26 15:35:21,676 p=1440820 u=root n=ansible | ok: [web1]
2025-07-26 15:35:21,683 p=1440820 u=root n=ansible | TASK [Verificación: Estado del servicio nginx] *****************************************************************************************************************************
2025-07-26 15:35:22,431 p=1440820 u=root n=ansible | ok: [web1]
2025-07-26 15:35:22,438 p=1440820 u=root n=ansible | TASK [Verificación: Comprobar que nginx está escuchando] *******************************************************************************************************************
2025-07-26 15:35:22,800 p=1440820 u=root n=ansible | skipping: [web1]
2025-07-26 15:35:22,807 p=1440820 u=root n=ansible | TASK [Info: Mostrar resumen de instalación] ********************************************************************************************************************************
2025-07-26 15:35:22,828 p=1440820 u=root n=ansible | ok: [web1] => {
    "msg": "=====================================\nINSTALACIÓN COMPLETADA\n=====================================\nHost: vamalaver01\nNginx Version: \nEstado: Instalado y funcionando\nPuerto: 80 activo\nPróximo paso: Configuración\n=====================================\n"
}
2025-07-26 15:35:22,836 p=1440820 u=root n=ansible | TASK [Config: Crear directorios para virtual hosts] ************************************************************************************************************************
2025-07-26 15:35:23,212 p=1440820 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,5 +1,5 @@[0m
[0;36m[0m {
[0;31m-    "group": 0,[0m
[0;31m[0m[0;31m-    "owner": 0,[0m
[0;31m[0m[0;32m+    "group": 33,[0m
[0;32m[0m[0;32m+    "owner": 33,[0m
[0;32m[0m     "path": "/etc/nginx/sites-available"
 }


2025-07-26 15:35:23,213 p=1440820 u=root n=ansible | changed: [web1] => (item=/etc/nginx/sites-available)
2025-07-26 15:35:23,431 p=1440820 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,5 +1,5 @@[0m
[0;36m[0m {
[0;31m-    "group": 0,[0m
[0;31m[0m[0;31m-    "owner": 0,[0m
[0;31m[0m[0;32m+    "group": 33,[0m
[0;32m[0m[0;32m+    "owner": 33,[0m
[0;32m[0m     "path": "/etc/nginx/sites-enabled"
 }


2025-07-26 15:35:23,432 p=1440820 u=root n=ansible | changed: [web1] => (item=/etc/nginx/sites-enabled)
2025-07-26 15:35:23,654 p=1440820 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,5 +1,5 @@[0m
[0;36m[0m {
[0;31m-    "group": 0,[0m
[0;31m[0m[0;31m-    "owner": 0,[0m
[0;31m[0m[0;32m+    "group": 33,[0m
[0;32m[0m[0;32m+    "owner": 33,[0m
[0;32m[0m     "path": "/etc/nginx/conf.d"
 }


2025-07-26 15:35:23,654 p=1440820 u=root n=ansible | changed: [web1] => (item=/etc/nginx/conf.d)
2025-07-26 15:35:23,662 p=1440820 u=root n=ansible | TASK [Config: Crear directorios de documentos web] *************************************************************************************************************************
2025-07-26 15:35:23,933 p=1440820 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,5 +1,5 @@[0m
[0;36m[0m {
[0;31m-    "group": 0,[0m
[0;31m[0m[0;31m-    "owner": 0,[0m
[0;31m[0m[0;32m+    "group": 33,[0m
[0;32m[0m[0;32m+    "owner": 33,[0m
[0;32m[0m     "path": "/var/www/html"
 }


2025-07-26 15:35:23,936 p=1440820 u=root n=ansible | changed: [web1] => (item={'name': 'default', 'server_name': '10.0.0.5', 'document_root': '/var/www/html', 'index_files': 'index.html index.htm'})
2025-07-26 15:35:24,156 p=1440820 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
     "path": "/var/www/empresa",
[0;31m-    "state": "absent"[0m
[0;31m[0m[0;32m+    "state": "directory"[0m
[0;32m[0m }


2025-07-26 15:35:24,156 p=1440820 u=root n=ansible | changed: [web1] => (item={'name': 'empresa', 'server_name': 'empresa.local', 'document_root': '/var/www/empresa', 'index_files': 'index.html'})
2025-07-26 15:35:24,164 p=1440820 u=root n=ansible | TASK [Config: Desplegar configuración principal de nginx] ******************************************************************************************************************
2025-07-26 15:35:25,160 p=1440820 u=root n=ansible | [0;31m--- before: /etc/nginx/nginx.conf[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-14408205qi7be7e/tmpf8zfjwae/nginx.conf.j2[0m
[0;32m[0m[0;36m@@ -1,83 +1,59 @@[0m
[0;36m[0m[0;32m+# templates/nginx.conf.j2 - Configuración principal de Nginx[0m
[0;32m[0m[0;32m+# Generado automáticamente por Ansible - NO EDITAR MANUALMENTE[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m user www-data;
[0;31m-worker_processes auto;[0m
[0;31m[0m[0;32m+worker_processes 2;[0m
[0;32m[0m pid /run/nginx.pid;
[0;31m-error_log /var/log/nginx/error.log;[0m
[0;31m[0m[0;31m-include /etc/nginx/modules-enabled/*.conf;[0m
[0;31m[0m 
[0;32m+# CONFIGURACIÓN DE EVENTOS[0m
[0;32m[0m events {
[0;31m-	worker_connections 768;[0m
[0;31m[0m[0;31m-	# multi_accept on;[0m
[0;31m[0m[0;32m+    worker_connections 1024;[0m
[0;32m[0m[0;32m+    use epoll;                             [0m
[0;32m[0m[0;32m+    multi_accept on;                       [0m
[0;32m[0m }
 
[0;32m+# CONFIGURACIÓN HTTP[0m
[0;32m[0m http {
[0;31m-[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-	# Basic Settings[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	sendfile on;[0m
[0;31m[0m[0;31m-	tcp_nopush on;[0m
[0;31m[0m[0;31m-	types_hash_max_size 2048;[0m
[0;31m[0m[0;31m-	# server_tokens off;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	# server_names_hash_bucket_size 64;[0m
[0;31m[0m[0;31m-	# server_name_in_redirect off;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	include /etc/nginx/mime.types;[0m
[0;31m[0m[0;31m-	default_type application/octet-stream;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-	# SSL Settings[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3; # Dropping SSLv3, ref: POODLE[0m
[0;31m[0m[0;31m-	ssl_prefer_server_ciphers on;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-	# Logging Settings[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	access_log /var/log/nginx/access.log;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-	# Gzip Settings[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	gzip on;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	# gzip_vary on;[0m
[0;31m[0m[0;31m-	# gzip_proxied any;[0m
[0;31m[0m[0;31m-	# gzip_comp_level 6;[0m
[0;31m[0m[0;31m-	# gzip_buffers 16 8k;[0m
[0;31m[0m[0;31m-	# gzip_http_version 1.1;[0m
[0;31m[0m[0;31m-	# gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-	# Virtual Host Configs[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	include /etc/nginx/conf.d/*.conf;[0m
[0;31m[0m[0;31m-	include /etc/nginx/sites-enabled/*;[0m
[0;31m[0m[0;31m-}[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-#mail {[0m
[0;31m[0m[0;31m-#	# See sample authentication script at:[0m
[0;31m[0m[0;31m-#	# http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-#	# auth_http localhost/auth.php;[0m
[0;31m[0m[0;31m-#	# pop3_capabilities "TOP" "USER";[0m
[0;31m[0m[0;31m-#	# imap_capabilities "IMAP4rev1" "UIDPLUS";[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-#	server {[0m
[0;31m[0m[0;31m-#		listen     localhost:110;[0m
[0;31m[0m[0;31m-#		protocol   pop3;[0m
[0;31m[0m[0;31m-#		proxy      on;[0m
[0;31m[0m[0;31m-#	}[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-#	server {[0m
[0;31m[0m[0;31m-#		listen     localhost:143;[0m
[0;31m[0m[0;31m-#		protocol   imap;[0m
[0;31m[0m[0;31m-#		proxy      on;[0m
[0;31m[0m[0;31m-#	}[0m
[0;31m[0m[0;31m-#}[0m
[0;31m[0m[0;32m+    # CONFIGURACIÓN BÁSICA[0m
[0;32m[0m[0;32m+    sendfile on;                           [0m
[0;32m[0m[0;32m+    tcp_nopush on;                         [0m
[0;32m[0m[0;32m+    tcp_nodelay on;                        [0m
[0;32m[0m[0;32m+    keepalive_timeout 65;[0m
[0;32m[0m[0;32m+    types_hash_max_size 2048;              [0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # CONFIGURACIÓN DE TAMAÑOS[0m
[0;32m[0m[0;32m+    client_max_body_size 10M;[0m
[0;32m[0m[0;32m+    client_body_buffer_size 128k;[0m
[0;32m[0m[0;32m+    client_header_buffer_size 1k;[0m
[0;32m[0m[0;32m+    large_client_header_buffers 4 4k;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # TIPOS MIME[0m
[0;32m[0m[0;32m+    include /etc/nginx/mime.types;[0m
[0;32m[0m[0;32m+    default_type application/octet-stream;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # CONFIGURACIÓN DE LOGGING[0m
[0;32m[0m[0;32m+    log_format main '$remote_addr - $remote_user [$time_local] "$request" '[0m
[0;32m[0m[0;32m+                    '$status $body_bytes_sent "$http_referer" '[0m
[0;32m[0m[0;32m+                    '"$http_user_agent" "$http_x_forwarded_for"';[0m
[0;32m[0m[0;32m+                    [0m
[0;32m[0m[0;32m+    access_log /var/log/nginx/access.log main;[0m
[0;32m[0m[0;32m+    error_log /var/log/nginx/error.log warn;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # CONFIGURACIÓN DE COMPRESIÓN[0m
[0;32m[0m[0;32m+    gzip on;[0m
[0;32m[0m[0;32m+    gzip_vary on;[0m
[0;32m[0m[0;32m+    gzip_proxied any;[0m
[0;32m[0m[0;32m+    gzip_comp_level 6;[0m
[0;32m[0m[0;32m+    gzip_types[0m
[0;32m[0m[0;32m+        text/plain[0m
[0;32m[0m[0;32m+        text/css[0m
[0;32m[0m[0;32m+        text/xml[0m
[0;32m[0m[0;32m+        text/javascript[0m
[0;32m[0m[0;32m+        application/javascript[0m
[0;32m[0m[0;32m+        application/xml+rss[0m
[0;32m[0m[0;32m+        application/json;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+        [0m
[0;32m[0m[0;32m+    # INCLUIR CONFIGURACIONES ADICIONALES[0m
[0;32m[0m[0;32m+    include /etc/nginx/conf.d/*.conf;[0m
[0;32m[0m[0;32m+    include /etc/nginx/sites-enabled/*;[0m
[0;32m[0m

2025-07-26 15:35:25,161 p=1440820 u=root n=ansible | changed: [web1]
2025-07-26 15:35:25,167 p=1440820 u=root n=ansible | TASK [Config: Desplegar configuración de virtual hosts] ********************************************************************************************************************
2025-07-26 15:35:25,233 p=1440820 u=root n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: If you are using a module and expect the file to exist on the remote, see the remote_src option
2025-07-26 15:35:25,233 p=1440820 u=root n=ansible | fatal: [web1]: FAILED! => {"changed": false, "msg": "Could not find or access 'default-site.j2'\nSearched in:\n\t/opt/nginx-lab/playbooks/templates/default-site.j2\n\t/opt/nginx-lab/playbooks/default-site.j2\n\t/opt/nginx-lab/playbooks/templates/default-site.j2\n\t/opt/nginx-lab/playbooks/default-site.j2 on the Ansible Controller.\nIf you are using a module and expect the file to exist on the remote, see the remote_src option"}
2025-07-26 15:35:25,234 p=1440820 u=root n=ansible | PLAY RECAP *****************************************************************************************************************************************************************
2025-07-26 15:35:25,235 p=1440820 u=root n=ansible | web1                       : ok=15   changed=6    unreachable=0    failed=1    skipped=3    rescued=0    ignored=0   
2025-07-26 15:36:34,323 p=1441187 u=root n=ansible | PLAY [LABORATORIO: Instalación y configuración completa de Nginx] **********************************************************************************************************
2025-07-26 15:36:34,333 p=1441187 u=root n=ansible | TASK [Gathering Facts] *****************************************************************************************************************************************************
2025-07-26 15:36:36,135 p=1441187 u=root n=ansible | ok: [web1]
2025-07-26 15:36:36,143 p=1441187 u=root n=ansible | TASK [Preparación: Mostrar información inicial] ****************************************************************************************************************************
2025-07-26 15:36:36,165 p=1441187 u=root n=ansible | ok: [web1] => {
    "msg": "=====================================\nINICIO DEL LABORATORIO NGINX\n=====================================\nHost: vamalaver01\nIP: 10.0.0.5\nSistema: Ubuntu 24.04\nEntorno: laboratorio\n=====================================\n"
}
2025-07-26 15:36:36,171 p=1441187 u=root n=ansible | TASK [Preparación: Actualizar cache de paquetes] ***************************************************************************************************************************
2025-07-26 15:36:37,208 p=1441187 u=root n=ansible | changed: [web1]
2025-07-26 15:36:37,224 p=1441187 u=root n=ansible | TASK [Debug: Verificar variables cargadas] *********************************************************************************************************************************
2025-07-26 15:36:37,274 p=1441187 u=root n=ansible | ok: [web1] => {
    "msg": "Variables del sistema:\n- system_packages: ['curl', 'wget', 'unzip', 'vim', 'htop', 'tree']\n- environment_name: laboratorio\n- timezone: America/Lima\n"
}
2025-07-26 15:36:37,281 p=1441187 u=root n=ansible | TASK [Sistema: Configurar timezone] ****************************************************************************************************************************************
2025-07-26 15:36:37,305 p=1441187 u=root n=ansible | skipping: [web1]
2025-07-26 15:36:37,312 p=1441187 u=root n=ansible | TASK [Sistema: Instalar paquetes del sistema] ******************************************************************************************************************************
2025-07-26 15:36:38,912 p=1441187 u=root n=ansible | Suggested packages:
  zip
The following NEW packages will be installed:
  tree unzip
0 upgraded, 2 newly installed, 0 to remove and 33 not upgraded.
2025-07-26 15:36:38,912 p=1441187 u=root n=ansible | changed: [web1]
2025-07-26 15:36:38,919 p=1441187 u=root n=ansible | TASK [Sistema: Crear usuario administrativo] *******************************************************************************************************************************
2025-07-26 15:36:39,382 p=1441187 u=root n=ansible | changed: [web1] => (item={'name': 'devops', 'comment': 'Usuario DevOps', 'groups': 'sudo', 'shell': '/bin/bash'})
2025-07-26 15:36:39,389 p=1441187 u=root n=ansible | TASK [Nginx: Instalar nginx] ***********************************************************************************************************************************************
2025-07-26 15:36:39,989 p=1441187 u=root n=ansible | ok: [web1]
2025-07-26 15:36:39,996 p=1441187 u=root n=ansible | TASK [Nginx: Verificar instalación] ****************************************************************************************************************************************
2025-07-26 15:36:40,341 p=1441187 u=root n=ansible | skipping: [web1]
2025-07-26 15:36:40,348 p=1441187 u=root n=ansible | TASK [Nginx: Mostrar versión instalada] ************************************************************************************************************************************
2025-07-26 15:36:40,369 p=1441187 u=root n=ansible | ok: [web1] => {
    "msg": "Nginx instalado: "
}
2025-07-26 15:36:40,376 p=1441187 u=root n=ansible | TASK [Sistema: Configurar logrotate básico] ********************************************************************************************************************************
2025-07-26 15:36:40,978 p=1441187 u=root n=ansible | ok: [web1]
2025-07-26 15:36:40,987 p=1441187 u=root n=ansible | TASK [Red: Configurar UFW si está habilitado] ******************************************************************************************************************************
2025-07-26 15:36:41,614 p=1441187 u=root n=ansible | ok: [web1]
2025-07-26 15:36:41,622 p=1441187 u=root n=ansible | TASK [Verificación: Estado del servicio nginx] *****************************************************************************************************************************
2025-07-26 15:36:42,392 p=1441187 u=root n=ansible | ok: [web1]
2025-07-26 15:36:42,399 p=1441187 u=root n=ansible | TASK [Verificación: Comprobar que nginx está escuchando] *******************************************************************************************************************
2025-07-26 15:36:42,757 p=1441187 u=root n=ansible | skipping: [web1]
2025-07-26 15:36:42,764 p=1441187 u=root n=ansible | TASK [Info: Mostrar resumen de instalación] ********************************************************************************************************************************
2025-07-26 15:36:42,785 p=1441187 u=root n=ansible | ok: [web1] => {
    "msg": "=====================================\nINSTALACIÓN COMPLETADA\n=====================================\nHost: vamalaver01\nNginx Version: \nEstado: Instalado y funcionando\nPuerto: 80 activo\nPróximo paso: Configuración\n=====================================\n"
}
2025-07-26 15:36:42,791 p=1441187 u=root n=ansible | TASK [Config: Crear directorios para virtual hosts] ************************************************************************************************************************
2025-07-26 15:36:43,172 p=1441187 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,5 +1,5 @@[0m
[0;36m[0m {
[0;31m-    "group": 0,[0m
[0;31m[0m[0;31m-    "owner": 0,[0m
[0;31m[0m[0;32m+    "group": 33,[0m
[0;32m[0m[0;32m+    "owner": 33,[0m
[0;32m[0m     "path": "/etc/nginx/sites-available"
 }


2025-07-26 15:36:43,173 p=1441187 u=root n=ansible | changed: [web1] => (item=/etc/nginx/sites-available)
2025-07-26 15:36:43,391 p=1441187 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,5 +1,5 @@[0m
[0;36m[0m {
[0;31m-    "group": 0,[0m
[0;31m[0m[0;31m-    "owner": 0,[0m
[0;31m[0m[0;32m+    "group": 33,[0m
[0;32m[0m[0;32m+    "owner": 33,[0m
[0;32m[0m     "path": "/etc/nginx/sites-enabled"
 }


2025-07-26 15:36:43,392 p=1441187 u=root n=ansible | changed: [web1] => (item=/etc/nginx/sites-enabled)
2025-07-26 15:36:43,620 p=1441187 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,5 +1,5 @@[0m
[0;36m[0m {
[0;31m-    "group": 0,[0m
[0;31m[0m[0;31m-    "owner": 0,[0m
[0;31m[0m[0;32m+    "group": 33,[0m
[0;32m[0m[0;32m+    "owner": 33,[0m
[0;32m[0m     "path": "/etc/nginx/conf.d"
 }


2025-07-26 15:36:43,620 p=1441187 u=root n=ansible | changed: [web1] => (item=/etc/nginx/conf.d)
2025-07-26 15:36:43,628 p=1441187 u=root n=ansible | TASK [Config: Crear directorios de documentos web] *************************************************************************************************************************
2025-07-26 15:36:43,900 p=1441187 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,5 +1,5 @@[0m
[0;36m[0m {
[0;31m-    "group": 0,[0m
[0;31m[0m[0;31m-    "owner": 0,[0m
[0;31m[0m[0;32m+    "group": 33,[0m
[0;32m[0m[0;32m+    "owner": 33,[0m
[0;32m[0m     "path": "/var/www/html"
 }


2025-07-26 15:36:43,901 p=1441187 u=root n=ansible | changed: [web1] => (item={'name': 'default', 'server_name': '10.0.0.5', 'document_root': '/var/www/html', 'index_files': 'index.html index.htm'})
2025-07-26 15:36:44,122 p=1441187 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
     "path": "/var/www/empresa",
[0;31m-    "state": "absent"[0m
[0;31m[0m[0;32m+    "state": "directory"[0m
[0;32m[0m }


2025-07-26 15:36:44,122 p=1441187 u=root n=ansible | changed: [web1] => (item={'name': 'empresa', 'server_name': 'empresa.local', 'document_root': '/var/www/empresa', 'index_files': 'index.html'})
2025-07-26 15:36:44,132 p=1441187 u=root n=ansible | TASK [Config: Desplegar configuración principal de nginx] ******************************************************************************************************************
2025-07-26 15:36:45,132 p=1441187 u=root n=ansible | [0;31m--- before: /etc/nginx/nginx.conf[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-1441187qe03wdfn/tmpsqhemh_i/nginx.conf.j2[0m
[0;32m[0m[0;36m@@ -1,83 +1,59 @@[0m
[0;36m[0m[0;32m+# templates/nginx.conf.j2 - Configuración principal de Nginx[0m
[0;32m[0m[0;32m+# Generado automáticamente por Ansible - NO EDITAR MANUALMENTE[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m user www-data;
[0;31m-worker_processes auto;[0m
[0;31m[0m[0;32m+worker_processes 2;[0m
[0;32m[0m pid /run/nginx.pid;
[0;31m-error_log /var/log/nginx/error.log;[0m
[0;31m[0m[0;31m-include /etc/nginx/modules-enabled/*.conf;[0m
[0;31m[0m 
[0;32m+# CONFIGURACIÓN DE EVENTOS[0m
[0;32m[0m events {
[0;31m-	worker_connections 768;[0m
[0;31m[0m[0;31m-	# multi_accept on;[0m
[0;31m[0m[0;32m+    worker_connections 1024;[0m
[0;32m[0m[0;32m+    use epoll;                             [0m
[0;32m[0m[0;32m+    multi_accept on;                       [0m
[0;32m[0m }
 
[0;32m+# CONFIGURACIÓN HTTP[0m
[0;32m[0m http {
[0;31m-[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-	# Basic Settings[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	sendfile on;[0m
[0;31m[0m[0;31m-	tcp_nopush on;[0m
[0;31m[0m[0;31m-	types_hash_max_size 2048;[0m
[0;31m[0m[0;31m-	# server_tokens off;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	# server_names_hash_bucket_size 64;[0m
[0;31m[0m[0;31m-	# server_name_in_redirect off;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	include /etc/nginx/mime.types;[0m
[0;31m[0m[0;31m-	default_type application/octet-stream;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-	# SSL Settings[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3; # Dropping SSLv3, ref: POODLE[0m
[0;31m[0m[0;31m-	ssl_prefer_server_ciphers on;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-	# Logging Settings[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	access_log /var/log/nginx/access.log;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-	# Gzip Settings[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	gzip on;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	# gzip_vary on;[0m
[0;31m[0m[0;31m-	# gzip_proxied any;[0m
[0;31m[0m[0;31m-	# gzip_comp_level 6;[0m
[0;31m[0m[0;31m-	# gzip_buffers 16 8k;[0m
[0;31m[0m[0;31m-	# gzip_http_version 1.1;[0m
[0;31m[0m[0;31m-	# gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-	# Virtual Host Configs[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	include /etc/nginx/conf.d/*.conf;[0m
[0;31m[0m[0;31m-	include /etc/nginx/sites-enabled/*;[0m
[0;31m[0m[0;31m-}[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-#mail {[0m
[0;31m[0m[0;31m-#	# See sample authentication script at:[0m
[0;31m[0m[0;31m-#	# http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-#	# auth_http localhost/auth.php;[0m
[0;31m[0m[0;31m-#	# pop3_capabilities "TOP" "USER";[0m
[0;31m[0m[0;31m-#	# imap_capabilities "IMAP4rev1" "UIDPLUS";[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-#	server {[0m
[0;31m[0m[0;31m-#		listen     localhost:110;[0m
[0;31m[0m[0;31m-#		protocol   pop3;[0m
[0;31m[0m[0;31m-#		proxy      on;[0m
[0;31m[0m[0;31m-#	}[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-#	server {[0m
[0;31m[0m[0;31m-#		listen     localhost:143;[0m
[0;31m[0m[0;31m-#		protocol   imap;[0m
[0;31m[0m[0;31m-#		proxy      on;[0m
[0;31m[0m[0;31m-#	}[0m
[0;31m[0m[0;31m-#}[0m
[0;31m[0m[0;32m+    # CONFIGURACIÓN BÁSICA[0m
[0;32m[0m[0;32m+    sendfile on;                           [0m
[0;32m[0m[0;32m+    tcp_nopush on;                         [0m
[0;32m[0m[0;32m+    tcp_nodelay on;                        [0m
[0;32m[0m[0;32m+    keepalive_timeout 65;[0m
[0;32m[0m[0;32m+    types_hash_max_size 2048;              [0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # CONFIGURACIÓN DE TAMAÑOS[0m
[0;32m[0m[0;32m+    client_max_body_size 10M;[0m
[0;32m[0m[0;32m+    client_body_buffer_size 128k;[0m
[0;32m[0m[0;32m+    client_header_buffer_size 1k;[0m
[0;32m[0m[0;32m+    large_client_header_buffers 4 4k;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # TIPOS MIME[0m
[0;32m[0m[0;32m+    include /etc/nginx/mime.types;[0m
[0;32m[0m[0;32m+    default_type application/octet-stream;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # CONFIGURACIÓN DE LOGGING[0m
[0;32m[0m[0;32m+    log_format main '$remote_addr - $remote_user [$time_local] "$request" '[0m
[0;32m[0m[0;32m+                    '$status $body_bytes_sent "$http_referer" '[0m
[0;32m[0m[0;32m+                    '"$http_user_agent" "$http_x_forwarded_for"';[0m
[0;32m[0m[0;32m+                    [0m
[0;32m[0m[0;32m+    access_log /var/log/nginx/access.log main;[0m
[0;32m[0m[0;32m+    error_log /var/log/nginx/error.log warn;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # CONFIGURACIÓN DE COMPRESIÓN[0m
[0;32m[0m[0;32m+    gzip on;[0m
[0;32m[0m[0;32m+    gzip_vary on;[0m
[0;32m[0m[0;32m+    gzip_proxied any;[0m
[0;32m[0m[0;32m+    gzip_comp_level 6;[0m
[0;32m[0m[0;32m+    gzip_types[0m
[0;32m[0m[0;32m+        text/plain[0m
[0;32m[0m[0;32m+        text/css[0m
[0;32m[0m[0;32m+        text/xml[0m
[0;32m[0m[0;32m+        text/javascript[0m
[0;32m[0m[0;32m+        application/javascript[0m
[0;32m[0m[0;32m+        application/xml+rss[0m
[0;32m[0m[0;32m+        application/json;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+        [0m
[0;32m[0m[0;32m+    # INCLUIR CONFIGURACIONES ADICIONALES[0m
[0;32m[0m[0;32m+    include /etc/nginx/conf.d/*.conf;[0m
[0;32m[0m[0;32m+    include /etc/nginx/sites-enabled/*;[0m
[0;32m[0m

2025-07-26 15:36:45,133 p=1441187 u=root n=ansible | changed: [web1]
2025-07-26 15:36:45,139 p=1441187 u=root n=ansible | TASK [Config: Desplegar configuración de virtual hosts] ********************************************************************************************************************
2025-07-26 15:36:45,898 p=1441187 u=root n=ansible | [0;31m--- before: /etc/nginx/sites-available/default[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-1441187qe03wdfn/tmp3yljb3uc/default-site.j2[0m
[0;32m[0m[0;36m@@ -1,91 +1,80 @@[0m
[0;36m[0m[0;31m-##[0m
[0;31m[0m[0;31m-# You should look at the following URL's in order to grasp a solid understanding[0m
[0;31m[0m[0;31m-# of Nginx configuration files in order to fully unleash the power of Nginx.[0m
[0;31m[0m[0;31m-# https://www.nginx.com/resources/wiki/start/[0m
[0;31m[0m[0;31m-# https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/[0m
[0;31m[0m[0;31m-# https://wiki.debian.org/Nginx/DirectoryStructure[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-# In most cases, administrators will remove this file from sites-enabled/ and[0m
[0;31m[0m[0;31m-# leave it as reference inside of sites-available where it will continue to be[0m
[0;31m[0m[0;31m-# updated by the nginx packaging team.[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-# This file will automatically load configuration files provided by other[0m
[0;31m[0m[0;31m-# applications, such as Drupal or Wordpress. These applications will be made[0m
[0;31m[0m[0;31m-# available underneath a path with that package name, such as /drupal8.[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-# Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.[0m
[0;31m[0m[0;31m-##[0m
[0;31m[0m[0;32m+# templates/default-site.j2 - Configuración del sitio por defecto[0m
[0;32m[0m 
[0;31m-# Default server configuration[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;32m+# VIRTUAL HOST: default[0m
[0;32m[0m server {
[0;31m-	listen 80 default_server;[0m
[0;31m[0m[0;31m-	listen [::]:80 default_server;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	# SSL configuration[0m
[0;31m[0m[0;31m-	#[0m
[0;31m[0m[0;31m-	# listen 443 ssl default_server;[0m
[0;31m[0m[0;31m-	# listen [::]:443 ssl default_server;[0m
[0;31m[0m[0;31m-	#[0m
[0;31m[0m[0;31m-	# Note: You should disable gzip for SSL traffic.[0m
[0;31m[0m[0;31m-	# See: https://bugs.debian.org/773332[0m
[0;31m[0m[0;31m-	#[0m
[0;31m[0m[0;31m-	# Read up on ssl_ciphers to ensure a secure configuration.[0m
[0;31m[0m[0;31m-	# See: https://bugs.debian.org/765782[0m
[0;31m[0m[0;31m-	#[0m
[0;31m[0m[0;31m-	# Self signed certs generated by the ssl-cert package[0m
[0;31m[0m[0;31m-	# Don't use them in a production server![0m
[0;31m[0m[0;31m-	#[0m
[0;31m[0m[0;31m-	# include snippets/snakeoil.conf;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	root /var/www/html;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	# Add index.php to the list if you are using PHP[0m
[0;31m[0m[0;31m-	index index.html index.htm index.nginx-debian.html;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	server_name _;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	location / {[0m
[0;31m[0m[0;31m-		# First attempt to serve request as file, then[0m
[0;31m[0m[0;31m-		# as directory, then fall back to displaying a 404.[0m
[0;31m[0m[0;31m-		try_files $uri $uri/ =404;[0m
[0;31m[0m[0;31m-	}[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	# pass PHP scripts to FastCGI server[0m
[0;31m[0m[0;31m-	#[0m
[0;31m[0m[0;31m-	#location ~ \.php$ {[0m
[0;31m[0m[0;31m-	#	include snippets/fastcgi-php.conf;[0m
[0;31m[0m[0;31m-	#[0m
[0;31m[0m[0;31m-	#	# With php-fpm (or other unix sockets):[0m
[0;31m[0m[0;31m-	#	fastcgi_pass unix:/run/php/php7.4-fpm.sock;[0m
[0;31m[0m[0;31m-	#	# With php-cgi (or other tcp sockets):[0m
[0;31m[0m[0;31m-	#	fastcgi_pass 127.0.0.1:9000;[0m
[0;31m[0m[0;31m-	#}[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	# deny access to .htaccess files, if Apache's document root[0m
[0;31m[0m[0;31m-	# concurs with nginx's one[0m
[0;31m[0m[0;31m-	#[0m
[0;31m[0m[0;31m-	#location ~ /\.ht {[0m
[0;31m[0m[0;31m-	#	deny all;[0m
[0;31m[0m[0;31m-	#}[0m
[0;31m[0m[0;31m-}[0m
[0;31m[0m[0;32m+    listen 80;[0m
[0;32m[0m[0;32m+        server_name 10.0.0.5 localhost;[0m
[0;32m[0m[0;32m+        [0m
[0;32m[0m[0;32m+    root /var/www/html;[0m
[0;32m[0m[0;32m+    index index.html index.htm;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # CONFIGURACIÓN DE LOGS ESPECÍFICOS[0m
[0;32m[0m[0;32m+    access_log /var/log/nginx/default_access.log main;[0m
[0;32m[0m[0;32m+    error_log /var/log/nginx/default_error.log warn;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # CONFIGURACIÓN DE UBICACIONES[0m
[0;32m[0m[0;32m+    location / {[0m
[0;32m[0m[0;32m+        try_files $uri $uri/ =404;[0m
[0;32m[0m[0;32m+    }[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # MANEJAR ARCHIVOS ESTÁTICOS[0m
[0;32m[0m[0;32m+    location ~* \.(jpg|jpeg|png|gif|ico|css|js)$ {[0m
[0;32m[0m[0;32m+        expires 1y;[0m
[0;32m[0m[0;32m+        add_header Cache-Control "public, immutable";[0m
[0;32m[0m[0;32m+    }[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # OCULTAR INFORMACIÓN SENSIBLE[0m
[0;32m[0m[0;32m+    location ~ /\.ht {[0m
[0;32m[0m[0;32m+        deny all;[0m
[0;32m[0m[0;32m+    }[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # PÁGINA DE ERROR PERSONALIZADA[0m
[0;32m[0m[0;32m+    error_page 404 /404.html;[0m
[0;32m[0m[0;32m+    error_page 500 502 503 504 /50x.html;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    location = /50x.html {[0m
[0;32m[0m[0;32m+        root /usr/share/nginx/html;[0m
[0;32m[0m[0;32m+    }[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    }[0m
[0;32m[0m 
 
[0;31m-# Virtual Host configuration for example.com[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-# You can move that to a different file under sites-available/ and symlink that[0m
[0;31m[0m[0;31m-# to sites-enabled/ to enable it.[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-#server {[0m
[0;31m[0m[0;31m-#	listen 80;[0m
[0;31m[0m[0;31m-#	listen [::]:80;[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-#	server_name example.com;[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-#	root /var/www/example.com;[0m
[0;31m[0m[0;31m-#	index index.html;[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-#	location / {[0m
[0;31m[0m[0;31m-#		try_files $uri $uri/ =404;[0m
[0;31m[0m[0;31m-#	}[0m
[0;31m[0m[0;31m-#}[0m
[0;31m[0m[0;32m+# VIRTUAL HOST: empresa[0m
[0;32m[0m[0;32m+server {[0m
[0;32m[0m[0;32m+    listen 80;[0m
[0;32m[0m[0;32m+        server_name empresa.local;[0m
[0;32m[0m[0;32m+        [0m
[0;32m[0m[0;32m+    root /var/www/empresa;[0m
[0;32m[0m[0;32m+    index index.html;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # CONFIGURACIÓN DE LOGS ESPECÍFICOS[0m
[0;32m[0m[0;32m+    access_log /var/log/nginx/empresa_access.log main;[0m
[0;32m[0m[0;32m+    error_log /var/log/nginx/empresa_error.log warn;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # CONFIGURACIÓN DE UBICACIONES[0m
[0;32m[0m[0;32m+    location / {[0m
[0;32m[0m[0;32m+        try_files $uri $uri/ =404;[0m
[0;32m[0m[0;32m+    }[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # MANEJAR ARCHIVOS ESTÁTICOS[0m
[0;32m[0m[0;32m+    location ~* \.(jpg|jpeg|png|gif|ico|css|js)$ {[0m
[0;32m[0m[0;32m+        expires 1y;[0m
[0;32m[0m[0;32m+        add_header Cache-Control "public, immutable";[0m
[0;32m[0m[0;32m+    }[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # OCULTAR INFORMACIÓN SENSIBLE[0m
[0;32m[0m[0;32m+    location ~ /\.ht {[0m
[0;32m[0m[0;32m+        deny all;[0m
[0;32m[0m[0;32m+    }[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # PÁGINA DE ERROR PERSONALIZADA[0m
[0;32m[0m[0;32m+    error_page 404 /404.html;[0m
[0;32m[0m[0;32m+    error_page 500 502 503 504 /50x.html;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    location = /50x.html {[0m
[0;32m[0m[0;32m+        root /usr/share/nginx/html;[0m
[0;32m[0m[0;32m+    }[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    }[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m

2025-07-26 15:36:45,898 p=1441187 u=root n=ansible | changed: [web1]
2025-07-26 15:36:45,904 p=1441187 u=root n=ansible | TASK [Config: Eliminar configuración original por defecto] *****************************************************************************************************************
2025-07-26 15:36:46,141 p=1441187 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
     "path": "/etc/nginx/sites-enabled/default",
[0;31m-    "state": "link"[0m
[0;31m[0m[0;32m+    "state": "absent"[0m
[0;32m[0m }


2025-07-26 15:36:46,141 p=1441187 u=root n=ansible | changed: [web1]
2025-07-26 15:36:46,148 p=1441187 u=root n=ansible | TASK [Config: Habilitar sitio personalizado] *******************************************************************************************************************************
2025-07-26 15:36:46,390 p=1441187 u=root n=ansible | ok: [web1]
2025-07-26 15:36:46,399 p=1441187 u=root n=ansible | TASK [Config: Desplegar páginas de inicio personalizadas] ******************************************************************************************************************
2025-07-26 15:36:46,929 p=1441187 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-1441187qe03wdfn/tmp94u161fp/index.html.j2[0m
[0;32m[0m[0;36m@@ -0,0 +1,111 @@[0m
[0;36m[0m[0;32m+<!DOCTYPE html>[0m
[0;32m[0m[0;32m+<html lang="es">[0m
[0;32m[0m[0;32m+<head>[0m
[0;32m[0m[0;32m+    <meta charset="UTF-8">[0m
[0;32m[0m[0;32m+    <meta name="viewport" content="width=device-width, initial-scale=1.0">[0m
[0;32m[0m[0;32m+    <title>Servidor Nginx - laboratorio</title>[0m
[0;32m[0m[0;32m+    <style>[0m
[0;32m[0m[0;32m+        body {[0m
[0;32m[0m[0;32m+            font-family: Arial, sans-serif;[0m
[0;32m[0m[0;32m+            line-height: 1.6;[0m
[0;32m[0m[0;32m+            margin: 0;[0m
[0;32m[0m[0;32m+            padding: 0;[0m
[0;32m[0m[0;32m+            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);[0m
[0;32m[0m[0;32m+            color: white;[0m
[0;32m[0m[0;32m+            min-height: 100vh;[0m
[0;32m[0m[0;32m+            display: flex;[0m
[0;32m[0m[0;32m+            align-items: center;[0m
[0;32m[0m[0;32m+            justify-content: center;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .container {[0m
[0;32m[0m[0;32m+            text-align: center;[0m
[0;32m[0m[0;32m+            background: rgba(255, 255, 255, 0.1);[0m
[0;32m[0m[0;32m+            padding: 2rem;[0m
[0;32m[0m[0;32m+            border-radius: 10px;[0m
[0;32m[0m[0;32m+            backdrop-filter: blur(10px);[0m
[0;32m[0m[0;32m+            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);[0m
[0;32m[0m[0;32m+            max-width: 600px;[0m
[0;32m[0m[0;32m+            margin: 0 auto;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        h1 {[0m
[0;32m[0m[0;32m+            font-size: 2.5rem;[0m
[0;32m[0m[0;32m+            margin-bottom: 1rem;[0m
[0;32m[0m[0;32m+            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .info-grid {[0m
[0;32m[0m[0;32m+            display: grid;[0m
[0;32m[0m[0;32m+            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));[0m
[0;32m[0m[0;32m+            gap: 1rem;[0m
[0;32m[0m[0;32m+            margin: 2rem 0;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .info-card {[0m
[0;32m[0m[0;32m+            background: rgba(255, 255, 255, 0.2);[0m
[0;32m[0m[0;32m+            padding: 1rem;[0m
[0;32m[0m[0;32m+            border-radius: 8px;[0m
[0;32m[0m[0;32m+            border: 1px solid rgba(255, 255, 255, 0.3);[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .info-card h3 {[0m
[0;32m[0m[0;32m+            margin: 0 0 0.5rem 0;[0m
[0;32m[0m[0;32m+            color: #FFD700;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .status {[0m
[0;32m[0m[0;32m+            background: #28a745;[0m
[0;32m[0m[0;32m+            color: white;[0m
[0;32m[0m[0;32m+            padding: 0.5rem 1rem;[0m
[0;32m[0m[0;32m+            border-radius: 20px;[0m
[0;32m[0m[0;32m+            display: inline-block;[0m
[0;32m[0m[0;32m+            margin: 1rem 0;[0m
[0;32m[0m[0;32m+            font-weight: bold;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .footer {[0m
[0;32m[0m[0;32m+            margin-top: 2rem;[0m
[0;32m[0m[0;32m+            padding-top: 1rem;[0m
[0;32m[0m[0;32m+            border-top: 1px solid rgba(255, 255, 255, 0.3);[0m
[0;32m[0m[0;32m+            font-size: 0.9rem;[0m
[0;32m[0m[0;32m+            opacity: 0.8;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+    </style>[0m
[0;32m[0m[0;32m+</head>[0m
[0;32m[0m[0;32m+<body>[0m
[0;32m[0m[0;32m+    <div class="container">[0m
[0;32m[0m[0;32m+        <h1>Servidor Nginx - laboratorio</h1>[0m
[0;32m[0m[0;32m+        [0m
[0;32m[0m[0;32m+        <div class="status">[0m
[0;32m[0m[0;32m+            Nginx configurado exitosamente[0m
[0;32m[0m[0;32m+        </div>[0m
[0;32m[0m[0;32m+        [0m
[0;32m[0m[0;32m+        <div class="info-grid">[0m
[0;32m[0m[0;32m+            <div class="info-card">[0m
[0;32m[0m[0;32m+                <h3>Servidor</h3>[0m
[0;32m[0m[0;32m+                <p>vamalaver01</p>[0m
[0;32m[0m[0;32m+                <p>10.0.0.5</p>[0m
[0;32m[0m[0;32m+            </div>[0m
[0;32m[0m[0;32m+            [0m
[0;32m[0m[0;32m+            <div class="info-card">[0m
[0;32m[0m[0;32m+                <h3>Sistema</h3>[0m
[0;32m[0m[0;32m+                <p>Ubuntu 24.04</p>[0m
[0;32m[0m[0;32m+                <p>x86_64</p>[0m
[0;32m[0m[0;32m+            </div>[0m
[0;32m[0m[0;32m+            [0m
[0;32m[0m[0;32m+            <div class="info-card">[0m
[0;32m[0m[0;32m+                <h3>Nginx</h3>[0m
[0;32m[0m[0;32m+                <p>Workers: 2</p>[0m
[0;32m[0m[0;32m+                <p>Conexiones: 1024</p>[0m
[0;32m[0m[0;32m+            </div>[0m
[0;32m[0m[0;32m+            [0m
[0;32m[0m[0;32m+            <div class="info-card">[0m
[0;32m[0m[0;32m+                <h3>Red</h3>[0m
[0;32m[0m[0;32m+                <p>HTTP: 80</p>[0m
[0;32m[0m[0;32m+                <p>HTTPS: 443</p>[0m
[0;32m[0m[0;32m+            </div>[0m
[0;32m[0m[0;32m+        </div>[0m
[0;32m[0m[0;32m+        [0m
[0;32m[0m[0;32m+        <div class="footer">[0m
[0;32m[0m[0;32m+            <p><strong>SFI Networks</strong></p>[0m
[0;32m[0m[0;32m+            <p>Desplegado: 2025-07-26 | Entorno: laboratorio</p>[0m
[0;32m[0m[0;32m+            <p>Administrador: aldo.malaver@runittech.com</p>[0m
[0;32m[0m[0;32m+        </div>[0m
[0;32m[0m[0;32m+    </div>[0m
[0;32m[0m[0;32m+</body>[0m
[0;32m[0m[0;32m+</html>[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m

2025-07-26 15:36:46,929 p=1441187 u=root n=ansible | changed: [web1] => (item={'name': 'default', 'server_name': '10.0.0.5', 'document_root': '/var/www/html', 'index_files': 'index.html index.htm'})
2025-07-26 15:36:47,405 p=1441187 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-1441187qe03wdfn/tmp_2n6w6bv/index.html.j2[0m
[0;32m[0m[0;36m@@ -0,0 +1,111 @@[0m
[0;36m[0m[0;32m+<!DOCTYPE html>[0m
[0;32m[0m[0;32m+<html lang="es">[0m
[0;32m[0m[0;32m+<head>[0m
[0;32m[0m[0;32m+    <meta charset="UTF-8">[0m
[0;32m[0m[0;32m+    <meta name="viewport" content="width=device-width, initial-scale=1.0">[0m
[0;32m[0m[0;32m+    <title>Servidor Nginx - laboratorio</title>[0m
[0;32m[0m[0;32m+    <style>[0m
[0;32m[0m[0;32m+        body {[0m
[0;32m[0m[0;32m+            font-family: Arial, sans-serif;[0m
[0;32m[0m[0;32m+            line-height: 1.6;[0m
[0;32m[0m[0;32m+            margin: 0;[0m
[0;32m[0m[0;32m+            padding: 0;[0m
[0;32m[0m[0;32m+            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);[0m
[0;32m[0m[0;32m+            color: white;[0m
[0;32m[0m[0;32m+            min-height: 100vh;[0m
[0;32m[0m[0;32m+            display: flex;[0m
[0;32m[0m[0;32m+            align-items: center;[0m
[0;32m[0m[0;32m+            justify-content: center;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .container {[0m
[0;32m[0m[0;32m+            text-align: center;[0m
[0;32m[0m[0;32m+            background: rgba(255, 255, 255, 0.1);[0m
[0;32m[0m[0;32m+            padding: 2rem;[0m
[0;32m[0m[0;32m+            border-radius: 10px;[0m
[0;32m[0m[0;32m+            backdrop-filter: blur(10px);[0m
[0;32m[0m[0;32m+            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);[0m
[0;32m[0m[0;32m+            max-width: 600px;[0m
[0;32m[0m[0;32m+            margin: 0 auto;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        h1 {[0m
[0;32m[0m[0;32m+            font-size: 2.5rem;[0m
[0;32m[0m[0;32m+            margin-bottom: 1rem;[0m
[0;32m[0m[0;32m+            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .info-grid {[0m
[0;32m[0m[0;32m+            display: grid;[0m
[0;32m[0m[0;32m+            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));[0m
[0;32m[0m[0;32m+            gap: 1rem;[0m
[0;32m[0m[0;32m+            margin: 2rem 0;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .info-card {[0m
[0;32m[0m[0;32m+            background: rgba(255, 255, 255, 0.2);[0m
[0;32m[0m[0;32m+            padding: 1rem;[0m
[0;32m[0m[0;32m+            border-radius: 8px;[0m
[0;32m[0m[0;32m+            border: 1px solid rgba(255, 255, 255, 0.3);[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .info-card h3 {[0m
[0;32m[0m[0;32m+            margin: 0 0 0.5rem 0;[0m
[0;32m[0m[0;32m+            color: #FFD700;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .status {[0m
[0;32m[0m[0;32m+            background: #28a745;[0m
[0;32m[0m[0;32m+            color: white;[0m
[0;32m[0m[0;32m+            padding: 0.5rem 1rem;[0m
[0;32m[0m[0;32m+            border-radius: 20px;[0m
[0;32m[0m[0;32m+            display: inline-block;[0m
[0;32m[0m[0;32m+            margin: 1rem 0;[0m
[0;32m[0m[0;32m+            font-weight: bold;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .footer {[0m
[0;32m[0m[0;32m+            margin-top: 2rem;[0m
[0;32m[0m[0;32m+            padding-top: 1rem;[0m
[0;32m[0m[0;32m+            border-top: 1px solid rgba(255, 255, 255, 0.3);[0m
[0;32m[0m[0;32m+            font-size: 0.9rem;[0m
[0;32m[0m[0;32m+            opacity: 0.8;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+    </style>[0m
[0;32m[0m[0;32m+</head>[0m
[0;32m[0m[0;32m+<body>[0m
[0;32m[0m[0;32m+    <div class="container">[0m
[0;32m[0m[0;32m+        <h1>Servidor Nginx - laboratorio</h1>[0m
[0;32m[0m[0;32m+        [0m
[0;32m[0m[0;32m+        <div class="status">[0m
[0;32m[0m[0;32m+            Nginx configurado exitosamente[0m
[0;32m[0m[0;32m+        </div>[0m
[0;32m[0m[0;32m+        [0m
[0;32m[0m[0;32m+        <div class="info-grid">[0m
[0;32m[0m[0;32m+            <div class="info-card">[0m
[0;32m[0m[0;32m+                <h3>Servidor</h3>[0m
[0;32m[0m[0;32m+                <p>vamalaver01</p>[0m
[0;32m[0m[0;32m+                <p>10.0.0.5</p>[0m
[0;32m[0m[0;32m+            </div>[0m
[0;32m[0m[0;32m+            [0m
[0;32m[0m[0;32m+            <div class="info-card">[0m
[0;32m[0m[0;32m+                <h3>Sistema</h3>[0m
[0;32m[0m[0;32m+                <p>Ubuntu 24.04</p>[0m
[0;32m[0m[0;32m+                <p>x86_64</p>[0m
[0;32m[0m[0;32m+            </div>[0m
[0;32m[0m[0;32m+            [0m
[0;32m[0m[0;32m+            <div class="info-card">[0m
[0;32m[0m[0;32m+                <h3>Nginx</h3>[0m
[0;32m[0m[0;32m+                <p>Workers: 2</p>[0m
[0;32m[0m[0;32m+                <p>Conexiones: 1024</p>[0m
[0;32m[0m[0;32m+            </div>[0m
[0;32m[0m[0;32m+            [0m
[0;32m[0m[0;32m+            <div class="info-card">[0m
[0;32m[0m[0;32m+                <h3>Red</h3>[0m
[0;32m[0m[0;32m+                <p>HTTP: 80</p>[0m
[0;32m[0m[0;32m+                <p>HTTPS: 443</p>[0m
[0;32m[0m[0;32m+            </div>[0m
[0;32m[0m[0;32m+        </div>[0m
[0;32m[0m[0;32m+        [0m
[0;32m[0m[0;32m+        <div class="footer">[0m
[0;32m[0m[0;32m+            <p><strong>SFI Networks</strong></p>[0m
[0;32m[0m[0;32m+            <p>Desplegado: 2025-07-26 | Entorno: laboratorio</p>[0m
[0;32m[0m[0;32m+            <p>Administrador: aldo.malaver@runittech.com</p>[0m
[0;32m[0m[0;32m+        </div>[0m
[0;32m[0m[0;32m+    </div>[0m
[0;32m[0m[0;32m+</body>[0m
[0;32m[0m[0;32m+</html>[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m

2025-07-26 15:36:47,406 p=1441187 u=root n=ansible | changed: [web1] => (item={'name': 'empresa', 'server_name': 'empresa.local', 'document_root': '/var/www/empresa', 'index_files': 'index.html'})
2025-07-26 15:36:47,413 p=1441187 u=root n=ansible | TASK [Config: Configurar logrotate para nginx] *****************************************************************************************************************************
2025-07-26 15:36:47,484 p=1441187 u=root n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: If you are using a module and expect the file to exist on the remote, see the remote_src option
2025-07-26 15:36:47,484 p=1441187 u=root n=ansible | fatal: [web1]: FAILED! => {"changed": false, "msg": "Could not find or access 'nginx-logrotate'\nSearched in:\n\t/opt/nginx-lab/playbooks/files/nginx-logrotate\n\t/opt/nginx-lab/playbooks/nginx-logrotate\n\t/opt/nginx-lab/playbooks/files/nginx-logrotate\n\t/opt/nginx-lab/playbooks/nginx-logrotate on the Ansible Controller.\nIf you are using a module and expect the file to exist on the remote, see the remote_src option"}
2025-07-26 15:36:47,486 p=1441187 u=root n=ansible | PLAY RECAP *****************************************************************************************************************************************************************
2025-07-26 15:36:47,486 p=1441187 u=root n=ansible | web1                       : ok=19   changed=9    unreachable=0    failed=1    skipped=3    rescued=0    ignored=0   
2025-07-26 15:37:28,686 p=1441460 u=root n=ansible | PLAY [LABORATORIO: Instalación y configuración completa de Nginx] **********************************************************************************************************
2025-07-26 15:37:28,697 p=1441460 u=root n=ansible | TASK [Gathering Facts] *****************************************************************************************************************************************************
2025-07-26 15:37:29,918 p=1441460 u=root n=ansible | ok: [web1]
2025-07-26 15:37:29,925 p=1441460 u=root n=ansible | TASK [Preparación: Mostrar información inicial] ****************************************************************************************************************************
2025-07-26 15:37:29,948 p=1441460 u=root n=ansible | ok: [web1] => {
    "msg": "=====================================\nINICIO DEL LABORATORIO NGINX\n=====================================\nHost: vamalaver01\nIP: 10.0.0.5\nSistema: Ubuntu 24.04\nEntorno: laboratorio\n=====================================\n"
}
2025-07-26 15:37:29,955 p=1441460 u=root n=ansible | TASK [Preparación: Actualizar cache de paquetes] ***************************************************************************************************************************
2025-07-26 15:37:30,970 p=1441460 u=root n=ansible | changed: [web1]
2025-07-26 15:37:30,987 p=1441460 u=root n=ansible | TASK [Debug: Verificar variables cargadas] *********************************************************************************************************************************
2025-07-26 15:37:31,032 p=1441460 u=root n=ansible | ok: [web1] => {
    "msg": "Variables del sistema:\n- system_packages: ['curl', 'wget', 'unzip', 'vim', 'htop', 'tree']\n- environment_name: laboratorio\n- timezone: America/Lima\n"
}
2025-07-26 15:37:31,038 p=1441460 u=root n=ansible | TASK [Sistema: Configurar timezone] ****************************************************************************************************************************************
2025-07-26 15:37:31,061 p=1441460 u=root n=ansible | skipping: [web1]
2025-07-26 15:37:31,067 p=1441460 u=root n=ansible | TASK [Sistema: Instalar paquetes del sistema] ******************************************************************************************************************************
2025-07-26 15:37:32,644 p=1441460 u=root n=ansible | Suggested packages:
  zip
The following NEW packages will be installed:
  tree unzip
0 upgraded, 2 newly installed, 0 to remove and 33 not upgraded.
2025-07-26 15:37:32,645 p=1441460 u=root n=ansible | changed: [web1]
2025-07-26 15:37:32,651 p=1441460 u=root n=ansible | TASK [Sistema: Crear usuario administrativo] *******************************************************************************************************************************
2025-07-26 15:37:33,123 p=1441460 u=root n=ansible | changed: [web1] => (item={'name': 'devops', 'comment': 'Usuario DevOps', 'groups': 'sudo', 'shell': '/bin/bash'})
2025-07-26 15:37:33,132 p=1441460 u=root n=ansible | TASK [Nginx: Instalar nginx] ***********************************************************************************************************************************************
2025-07-26 15:37:33,729 p=1441460 u=root n=ansible | ok: [web1]
2025-07-26 15:37:33,736 p=1441460 u=root n=ansible | TASK [Nginx: Verificar instalación] ****************************************************************************************************************************************
2025-07-26 15:37:34,099 p=1441460 u=root n=ansible | skipping: [web1]
2025-07-26 15:37:34,106 p=1441460 u=root n=ansible | TASK [Nginx: Mostrar versión instalada] ************************************************************************************************************************************
2025-07-26 15:37:34,129 p=1441460 u=root n=ansible | ok: [web1] => {
    "msg": "Nginx instalado: "
}
2025-07-26 15:37:34,138 p=1441460 u=root n=ansible | TASK [Sistema: Configurar logrotate básico] ********************************************************************************************************************************
2025-07-26 15:37:34,740 p=1441460 u=root n=ansible | ok: [web1]
2025-07-26 15:37:34,750 p=1441460 u=root n=ansible | TASK [Red: Configurar UFW si está habilitado] ******************************************************************************************************************************
2025-07-26 15:37:35,378 p=1441460 u=root n=ansible | ok: [web1]
2025-07-26 15:37:35,386 p=1441460 u=root n=ansible | TASK [Verificación: Estado del servicio nginx] *****************************************************************************************************************************
2025-07-26 15:37:36,132 p=1441460 u=root n=ansible | ok: [web1]
2025-07-26 15:37:36,138 p=1441460 u=root n=ansible | TASK [Verificación: Comprobar que nginx está escuchando] *******************************************************************************************************************
2025-07-26 15:37:36,498 p=1441460 u=root n=ansible | skipping: [web1]
2025-07-26 15:37:36,506 p=1441460 u=root n=ansible | TASK [Info: Mostrar resumen de instalación] ********************************************************************************************************************************
2025-07-26 15:37:36,530 p=1441460 u=root n=ansible | ok: [web1] => {
    "msg": "=====================================\nINSTALACIÓN COMPLETADA\n=====================================\nHost: vamalaver01\nNginx Version: \nEstado: Instalado y funcionando\nPuerto: 80 activo\nPróximo paso: Configuración\n=====================================\n"
}
2025-07-26 15:37:36,536 p=1441460 u=root n=ansible | TASK [Config: Crear directorios para virtual hosts] ************************************************************************************************************************
2025-07-26 15:37:36,914 p=1441460 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,5 +1,5 @@[0m
[0;36m[0m {
[0;31m-    "group": 0,[0m
[0;31m[0m[0;31m-    "owner": 0,[0m
[0;31m[0m[0;32m+    "group": 33,[0m
[0;32m[0m[0;32m+    "owner": 33,[0m
[0;32m[0m     "path": "/etc/nginx/sites-available"
 }


2025-07-26 15:37:36,915 p=1441460 u=root n=ansible | changed: [web1] => (item=/etc/nginx/sites-available)
2025-07-26 15:37:37,136 p=1441460 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,5 +1,5 @@[0m
[0;36m[0m {
[0;31m-    "group": 0,[0m
[0;31m[0m[0;31m-    "owner": 0,[0m
[0;31m[0m[0;32m+    "group": 33,[0m
[0;32m[0m[0;32m+    "owner": 33,[0m
[0;32m[0m     "path": "/etc/nginx/sites-enabled"
 }


2025-07-26 15:37:37,137 p=1441460 u=root n=ansible | changed: [web1] => (item=/etc/nginx/sites-enabled)
2025-07-26 15:37:37,356 p=1441460 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,5 +1,5 @@[0m
[0;36m[0m {
[0;31m-    "group": 0,[0m
[0;31m[0m[0;31m-    "owner": 0,[0m
[0;31m[0m[0;32m+    "group": 33,[0m
[0;32m[0m[0;32m+    "owner": 33,[0m
[0;32m[0m     "path": "/etc/nginx/conf.d"
 }


2025-07-26 15:37:37,357 p=1441460 u=root n=ansible | changed: [web1] => (item=/etc/nginx/conf.d)
2025-07-26 15:37:37,364 p=1441460 u=root n=ansible | TASK [Config: Crear directorios de documentos web] *************************************************************************************************************************
2025-07-26 15:37:37,634 p=1441460 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,5 +1,5 @@[0m
[0;36m[0m {
[0;31m-    "group": 0,[0m
[0;31m[0m[0;31m-    "owner": 0,[0m
[0;31m[0m[0;32m+    "group": 33,[0m
[0;32m[0m[0;32m+    "owner": 33,[0m
[0;32m[0m     "path": "/var/www/html"
 }


2025-07-26 15:37:37,635 p=1441460 u=root n=ansible | changed: [web1] => (item={'name': 'default', 'server_name': '10.0.0.5', 'document_root': '/var/www/html', 'index_files': 'index.html index.htm'})
2025-07-26 15:37:37,855 p=1441460 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
     "path": "/var/www/empresa",
[0;31m-    "state": "absent"[0m
[0;31m[0m[0;32m+    "state": "directory"[0m
[0;32m[0m }


2025-07-26 15:37:37,855 p=1441460 u=root n=ansible | changed: [web1] => (item={'name': 'empresa', 'server_name': 'empresa.local', 'document_root': '/var/www/empresa', 'index_files': 'index.html'})
2025-07-26 15:37:37,866 p=1441460 u=root n=ansible | TASK [Config: Desplegar configuración principal de nginx] ******************************************************************************************************************
2025-07-26 15:37:38,864 p=1441460 u=root n=ansible | [0;31m--- before: /etc/nginx/nginx.conf[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-1441460azm8_dpp/tmpmsvnx2q7/nginx.conf.j2[0m
[0;32m[0m[0;36m@@ -1,83 +1,59 @@[0m
[0;36m[0m[0;32m+# templates/nginx.conf.j2 - Configuración principal de Nginx[0m
[0;32m[0m[0;32m+# Generado automáticamente por Ansible - NO EDITAR MANUALMENTE[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m user www-data;
[0;31m-worker_processes auto;[0m
[0;31m[0m[0;32m+worker_processes 2;[0m
[0;32m[0m pid /run/nginx.pid;
[0;31m-error_log /var/log/nginx/error.log;[0m
[0;31m[0m[0;31m-include /etc/nginx/modules-enabled/*.conf;[0m
[0;31m[0m 
[0;32m+# CONFIGURACIÓN DE EVENTOS[0m
[0;32m[0m events {
[0;31m-	worker_connections 768;[0m
[0;31m[0m[0;31m-	# multi_accept on;[0m
[0;31m[0m[0;32m+    worker_connections 1024;[0m
[0;32m[0m[0;32m+    use epoll;                             [0m
[0;32m[0m[0;32m+    multi_accept on;                       [0m
[0;32m[0m }
 
[0;32m+# CONFIGURACIÓN HTTP[0m
[0;32m[0m http {
[0;31m-[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-	# Basic Settings[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	sendfile on;[0m
[0;31m[0m[0;31m-	tcp_nopush on;[0m
[0;31m[0m[0;31m-	types_hash_max_size 2048;[0m
[0;31m[0m[0;31m-	# server_tokens off;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	# server_names_hash_bucket_size 64;[0m
[0;31m[0m[0;31m-	# server_name_in_redirect off;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	include /etc/nginx/mime.types;[0m
[0;31m[0m[0;31m-	default_type application/octet-stream;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-	# SSL Settings[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3; # Dropping SSLv3, ref: POODLE[0m
[0;31m[0m[0;31m-	ssl_prefer_server_ciphers on;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-	# Logging Settings[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	access_log /var/log/nginx/access.log;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-	# Gzip Settings[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	gzip on;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	# gzip_vary on;[0m
[0;31m[0m[0;31m-	# gzip_proxied any;[0m
[0;31m[0m[0;31m-	# gzip_comp_level 6;[0m
[0;31m[0m[0;31m-	# gzip_buffers 16 8k;[0m
[0;31m[0m[0;31m-	# gzip_http_version 1.1;[0m
[0;31m[0m[0;31m-	# gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-	# Virtual Host Configs[0m
[0;31m[0m[0;31m-	##[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	include /etc/nginx/conf.d/*.conf;[0m
[0;31m[0m[0;31m-	include /etc/nginx/sites-enabled/*;[0m
[0;31m[0m[0;31m-}[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-#mail {[0m
[0;31m[0m[0;31m-#	# See sample authentication script at:[0m
[0;31m[0m[0;31m-#	# http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-#	# auth_http localhost/auth.php;[0m
[0;31m[0m[0;31m-#	# pop3_capabilities "TOP" "USER";[0m
[0;31m[0m[0;31m-#	# imap_capabilities "IMAP4rev1" "UIDPLUS";[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-#	server {[0m
[0;31m[0m[0;31m-#		listen     localhost:110;[0m
[0;31m[0m[0;31m-#		protocol   pop3;[0m
[0;31m[0m[0;31m-#		proxy      on;[0m
[0;31m[0m[0;31m-#	}[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-#	server {[0m
[0;31m[0m[0;31m-#		listen     localhost:143;[0m
[0;31m[0m[0;31m-#		protocol   imap;[0m
[0;31m[0m[0;31m-#		proxy      on;[0m
[0;31m[0m[0;31m-#	}[0m
[0;31m[0m[0;31m-#}[0m
[0;31m[0m[0;32m+    # CONFIGURACIÓN BÁSICA[0m
[0;32m[0m[0;32m+    sendfile on;                           [0m
[0;32m[0m[0;32m+    tcp_nopush on;                         [0m
[0;32m[0m[0;32m+    tcp_nodelay on;                        [0m
[0;32m[0m[0;32m+    keepalive_timeout 65;[0m
[0;32m[0m[0;32m+    types_hash_max_size 2048;              [0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # CONFIGURACIÓN DE TAMAÑOS[0m
[0;32m[0m[0;32m+    client_max_body_size 10M;[0m
[0;32m[0m[0;32m+    client_body_buffer_size 128k;[0m
[0;32m[0m[0;32m+    client_header_buffer_size 1k;[0m
[0;32m[0m[0;32m+    large_client_header_buffers 4 4k;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # TIPOS MIME[0m
[0;32m[0m[0;32m+    include /etc/nginx/mime.types;[0m
[0;32m[0m[0;32m+    default_type application/octet-stream;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # CONFIGURACIÓN DE LOGGING[0m
[0;32m[0m[0;32m+    log_format main '$remote_addr - $remote_user [$time_local] "$request" '[0m
[0;32m[0m[0;32m+                    '$status $body_bytes_sent "$http_referer" '[0m
[0;32m[0m[0;32m+                    '"$http_user_agent" "$http_x_forwarded_for"';[0m
[0;32m[0m[0;32m+                    [0m
[0;32m[0m[0;32m+    access_log /var/log/nginx/access.log main;[0m
[0;32m[0m[0;32m+    error_log /var/log/nginx/error.log warn;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # CONFIGURACIÓN DE COMPRESIÓN[0m
[0;32m[0m[0;32m+    gzip on;[0m
[0;32m[0m[0;32m+    gzip_vary on;[0m
[0;32m[0m[0;32m+    gzip_proxied any;[0m
[0;32m[0m[0;32m+    gzip_comp_level 6;[0m
[0;32m[0m[0;32m+    gzip_types[0m
[0;32m[0m[0;32m+        text/plain[0m
[0;32m[0m[0;32m+        text/css[0m
[0;32m[0m[0;32m+        text/xml[0m
[0;32m[0m[0;32m+        text/javascript[0m
[0;32m[0m[0;32m+        application/javascript[0m
[0;32m[0m[0;32m+        application/xml+rss[0m
[0;32m[0m[0;32m+        application/json;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+        [0m
[0;32m[0m[0;32m+    # INCLUIR CONFIGURACIONES ADICIONALES[0m
[0;32m[0m[0;32m+    include /etc/nginx/conf.d/*.conf;[0m
[0;32m[0m[0;32m+    include /etc/nginx/sites-enabled/*;[0m
[0;32m[0m

2025-07-26 15:37:38,865 p=1441460 u=root n=ansible | changed: [web1]
2025-07-26 15:37:38,871 p=1441460 u=root n=ansible | TASK [Config: Desplegar configuración de virtual hosts] ********************************************************************************************************************
2025-07-26 15:37:39,622 p=1441460 u=root n=ansible | [0;31m--- before: /etc/nginx/sites-available/default[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-1441460azm8_dpp/tmpn_v5hd2l/default-site.j2[0m
[0;32m[0m[0;36m@@ -1,91 +1,80 @@[0m
[0;36m[0m[0;31m-##[0m
[0;31m[0m[0;31m-# You should look at the following URL's in order to grasp a solid understanding[0m
[0;31m[0m[0;31m-# of Nginx configuration files in order to fully unleash the power of Nginx.[0m
[0;31m[0m[0;31m-# https://www.nginx.com/resources/wiki/start/[0m
[0;31m[0m[0;31m-# https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/[0m
[0;31m[0m[0;31m-# https://wiki.debian.org/Nginx/DirectoryStructure[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-# In most cases, administrators will remove this file from sites-enabled/ and[0m
[0;31m[0m[0;31m-# leave it as reference inside of sites-available where it will continue to be[0m
[0;31m[0m[0;31m-# updated by the nginx packaging team.[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-# This file will automatically load configuration files provided by other[0m
[0;31m[0m[0;31m-# applications, such as Drupal or Wordpress. These applications will be made[0m
[0;31m[0m[0;31m-# available underneath a path with that package name, such as /drupal8.[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-# Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.[0m
[0;31m[0m[0;31m-##[0m
[0;31m[0m[0;32m+# templates/default-site.j2 - Configuración del sitio por defecto[0m
[0;32m[0m 
[0;31m-# Default server configuration[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;32m+# VIRTUAL HOST: default[0m
[0;32m[0m server {
[0;31m-	listen 80 default_server;[0m
[0;31m[0m[0;31m-	listen [::]:80 default_server;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	# SSL configuration[0m
[0;31m[0m[0;31m-	#[0m
[0;31m[0m[0;31m-	# listen 443 ssl default_server;[0m
[0;31m[0m[0;31m-	# listen [::]:443 ssl default_server;[0m
[0;31m[0m[0;31m-	#[0m
[0;31m[0m[0;31m-	# Note: You should disable gzip for SSL traffic.[0m
[0;31m[0m[0;31m-	# See: https://bugs.debian.org/773332[0m
[0;31m[0m[0;31m-	#[0m
[0;31m[0m[0;31m-	# Read up on ssl_ciphers to ensure a secure configuration.[0m
[0;31m[0m[0;31m-	# See: https://bugs.debian.org/765782[0m
[0;31m[0m[0;31m-	#[0m
[0;31m[0m[0;31m-	# Self signed certs generated by the ssl-cert package[0m
[0;31m[0m[0;31m-	# Don't use them in a production server![0m
[0;31m[0m[0;31m-	#[0m
[0;31m[0m[0;31m-	# include snippets/snakeoil.conf;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	root /var/www/html;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	# Add index.php to the list if you are using PHP[0m
[0;31m[0m[0;31m-	index index.html index.htm index.nginx-debian.html;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	server_name _;[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	location / {[0m
[0;31m[0m[0;31m-		# First attempt to serve request as file, then[0m
[0;31m[0m[0;31m-		# as directory, then fall back to displaying a 404.[0m
[0;31m[0m[0;31m-		try_files $uri $uri/ =404;[0m
[0;31m[0m[0;31m-	}[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	# pass PHP scripts to FastCGI server[0m
[0;31m[0m[0;31m-	#[0m
[0;31m[0m[0;31m-	#location ~ \.php$ {[0m
[0;31m[0m[0;31m-	#	include snippets/fastcgi-php.conf;[0m
[0;31m[0m[0;31m-	#[0m
[0;31m[0m[0;31m-	#	# With php-fpm (or other unix sockets):[0m
[0;31m[0m[0;31m-	#	fastcgi_pass unix:/run/php/php7.4-fpm.sock;[0m
[0;31m[0m[0;31m-	#	# With php-cgi (or other tcp sockets):[0m
[0;31m[0m[0;31m-	#	fastcgi_pass 127.0.0.1:9000;[0m
[0;31m[0m[0;31m-	#}[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;31m-	# deny access to .htaccess files, if Apache's document root[0m
[0;31m[0m[0;31m-	# concurs with nginx's one[0m
[0;31m[0m[0;31m-	#[0m
[0;31m[0m[0;31m-	#location ~ /\.ht {[0m
[0;31m[0m[0;31m-	#	deny all;[0m
[0;31m[0m[0;31m-	#}[0m
[0;31m[0m[0;31m-}[0m
[0;31m[0m[0;32m+    listen 80;[0m
[0;32m[0m[0;32m+        server_name 10.0.0.5 localhost;[0m
[0;32m[0m[0;32m+        [0m
[0;32m[0m[0;32m+    root /var/www/html;[0m
[0;32m[0m[0;32m+    index index.html index.htm;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # CONFIGURACIÓN DE LOGS ESPECÍFICOS[0m
[0;32m[0m[0;32m+    access_log /var/log/nginx/default_access.log main;[0m
[0;32m[0m[0;32m+    error_log /var/log/nginx/default_error.log warn;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # CONFIGURACIÓN DE UBICACIONES[0m
[0;32m[0m[0;32m+    location / {[0m
[0;32m[0m[0;32m+        try_files $uri $uri/ =404;[0m
[0;32m[0m[0;32m+    }[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # MANEJAR ARCHIVOS ESTÁTICOS[0m
[0;32m[0m[0;32m+    location ~* \.(jpg|jpeg|png|gif|ico|css|js)$ {[0m
[0;32m[0m[0;32m+        expires 1y;[0m
[0;32m[0m[0;32m+        add_header Cache-Control "public, immutable";[0m
[0;32m[0m[0;32m+    }[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # OCULTAR INFORMACIÓN SENSIBLE[0m
[0;32m[0m[0;32m+    location ~ /\.ht {[0m
[0;32m[0m[0;32m+        deny all;[0m
[0;32m[0m[0;32m+    }[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # PÁGINA DE ERROR PERSONALIZADA[0m
[0;32m[0m[0;32m+    error_page 404 /404.html;[0m
[0;32m[0m[0;32m+    error_page 500 502 503 504 /50x.html;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    location = /50x.html {[0m
[0;32m[0m[0;32m+        root /usr/share/nginx/html;[0m
[0;32m[0m[0;32m+    }[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    }[0m
[0;32m[0m 
 
[0;31m-# Virtual Host configuration for example.com[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-# You can move that to a different file under sites-available/ and symlink that[0m
[0;31m[0m[0;31m-# to sites-enabled/ to enable it.[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-#server {[0m
[0;31m[0m[0;31m-#	listen 80;[0m
[0;31m[0m[0;31m-#	listen [::]:80;[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-#	server_name example.com;[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-#	root /var/www/example.com;[0m
[0;31m[0m[0;31m-#	index index.html;[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-#	location / {[0m
[0;31m[0m[0;31m-#		try_files $uri $uri/ =404;[0m
[0;31m[0m[0;31m-#	}[0m
[0;31m[0m[0;31m-#}[0m
[0;31m[0m[0;32m+# VIRTUAL HOST: empresa[0m
[0;32m[0m[0;32m+server {[0m
[0;32m[0m[0;32m+    listen 80;[0m
[0;32m[0m[0;32m+        server_name empresa.local;[0m
[0;32m[0m[0;32m+        [0m
[0;32m[0m[0;32m+    root /var/www/empresa;[0m
[0;32m[0m[0;32m+    index index.html;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # CONFIGURACIÓN DE LOGS ESPECÍFICOS[0m
[0;32m[0m[0;32m+    access_log /var/log/nginx/empresa_access.log main;[0m
[0;32m[0m[0;32m+    error_log /var/log/nginx/empresa_error.log warn;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # CONFIGURACIÓN DE UBICACIONES[0m
[0;32m[0m[0;32m+    location / {[0m
[0;32m[0m[0;32m+        try_files $uri $uri/ =404;[0m
[0;32m[0m[0;32m+    }[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # MANEJAR ARCHIVOS ESTÁTICOS[0m
[0;32m[0m[0;32m+    location ~* \.(jpg|jpeg|png|gif|ico|css|js)$ {[0m
[0;32m[0m[0;32m+        expires 1y;[0m
[0;32m[0m[0;32m+        add_header Cache-Control "public, immutable";[0m
[0;32m[0m[0;32m+    }[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # OCULTAR INFORMACIÓN SENSIBLE[0m
[0;32m[0m[0;32m+    location ~ /\.ht {[0m
[0;32m[0m[0;32m+        deny all;[0m
[0;32m[0m[0;32m+    }[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    # PÁGINA DE ERROR PERSONALIZADA[0m
[0;32m[0m[0;32m+    error_page 404 /404.html;[0m
[0;32m[0m[0;32m+    error_page 500 502 503 504 /50x.html;[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    location = /50x.html {[0m
[0;32m[0m[0;32m+        root /usr/share/nginx/html;[0m
[0;32m[0m[0;32m+    }[0m
[0;32m[0m[0;32m+    [0m
[0;32m[0m[0;32m+    }[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m

2025-07-26 15:37:39,623 p=1441460 u=root n=ansible | changed: [web1]
2025-07-26 15:37:39,629 p=1441460 u=root n=ansible | TASK [Config: Eliminar configuración original por defecto] *****************************************************************************************************************
2025-07-26 15:37:39,878 p=1441460 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
     "path": "/etc/nginx/sites-enabled/default",
[0;31m-    "state": "link"[0m
[0;31m[0m[0;32m+    "state": "absent"[0m
[0;32m[0m }


2025-07-26 15:37:39,878 p=1441460 u=root n=ansible | changed: [web1]
2025-07-26 15:37:39,884 p=1441460 u=root n=ansible | TASK [Config: Habilitar sitio personalizado] *******************************************************************************************************************************
2025-07-26 15:37:40,123 p=1441460 u=root n=ansible | ok: [web1]
2025-07-26 15:37:40,132 p=1441460 u=root n=ansible | TASK [Config: Desplegar páginas de inicio personalizadas] ******************************************************************************************************************
2025-07-26 15:37:40,674 p=1441460 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-1441460azm8_dpp/tmpnktejqn7/index.html.j2[0m
[0;32m[0m[0;36m@@ -0,0 +1,111 @@[0m
[0;36m[0m[0;32m+<!DOCTYPE html>[0m
[0;32m[0m[0;32m+<html lang="es">[0m
[0;32m[0m[0;32m+<head>[0m
[0;32m[0m[0;32m+    <meta charset="UTF-8">[0m
[0;32m[0m[0;32m+    <meta name="viewport" content="width=device-width, initial-scale=1.0">[0m
[0;32m[0m[0;32m+    <title>Servidor Nginx - laboratorio</title>[0m
[0;32m[0m[0;32m+    <style>[0m
[0;32m[0m[0;32m+        body {[0m
[0;32m[0m[0;32m+            font-family: Arial, sans-serif;[0m
[0;32m[0m[0;32m+            line-height: 1.6;[0m
[0;32m[0m[0;32m+            margin: 0;[0m
[0;32m[0m[0;32m+            padding: 0;[0m
[0;32m[0m[0;32m+            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);[0m
[0;32m[0m[0;32m+            color: white;[0m
[0;32m[0m[0;32m+            min-height: 100vh;[0m
[0;32m[0m[0;32m+            display: flex;[0m
[0;32m[0m[0;32m+            align-items: center;[0m
[0;32m[0m[0;32m+            justify-content: center;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .container {[0m
[0;32m[0m[0;32m+            text-align: center;[0m
[0;32m[0m[0;32m+            background: rgba(255, 255, 255, 0.1);[0m
[0;32m[0m[0;32m+            padding: 2rem;[0m
[0;32m[0m[0;32m+            border-radius: 10px;[0m
[0;32m[0m[0;32m+            backdrop-filter: blur(10px);[0m
[0;32m[0m[0;32m+            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);[0m
[0;32m[0m[0;32m+            max-width: 600px;[0m
[0;32m[0m[0;32m+            margin: 0 auto;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        h1 {[0m
[0;32m[0m[0;32m+            font-size: 2.5rem;[0m
[0;32m[0m[0;32m+            margin-bottom: 1rem;[0m
[0;32m[0m[0;32m+            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .info-grid {[0m
[0;32m[0m[0;32m+            display: grid;[0m
[0;32m[0m[0;32m+            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));[0m
[0;32m[0m[0;32m+            gap: 1rem;[0m
[0;32m[0m[0;32m+            margin: 2rem 0;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .info-card {[0m
[0;32m[0m[0;32m+            background: rgba(255, 255, 255, 0.2);[0m
[0;32m[0m[0;32m+            padding: 1rem;[0m
[0;32m[0m[0;32m+            border-radius: 8px;[0m
[0;32m[0m[0;32m+            border: 1px solid rgba(255, 255, 255, 0.3);[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .info-card h3 {[0m
[0;32m[0m[0;32m+            margin: 0 0 0.5rem 0;[0m
[0;32m[0m[0;32m+            color: #FFD700;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .status {[0m
[0;32m[0m[0;32m+            background: #28a745;[0m
[0;32m[0m[0;32m+            color: white;[0m
[0;32m[0m[0;32m+            padding: 0.5rem 1rem;[0m
[0;32m[0m[0;32m+            border-radius: 20px;[0m
[0;32m[0m[0;32m+            display: inline-block;[0m
[0;32m[0m[0;32m+            margin: 1rem 0;[0m
[0;32m[0m[0;32m+            font-weight: bold;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .footer {[0m
[0;32m[0m[0;32m+            margin-top: 2rem;[0m
[0;32m[0m[0;32m+            padding-top: 1rem;[0m
[0;32m[0m[0;32m+            border-top: 1px solid rgba(255, 255, 255, 0.3);[0m
[0;32m[0m[0;32m+            font-size: 0.9rem;[0m
[0;32m[0m[0;32m+            opacity: 0.8;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+    </style>[0m
[0;32m[0m[0;32m+</head>[0m
[0;32m[0m[0;32m+<body>[0m
[0;32m[0m[0;32m+    <div class="container">[0m
[0;32m[0m[0;32m+        <h1>Servidor Nginx - laboratorio</h1>[0m
[0;32m[0m[0;32m+        [0m
[0;32m[0m[0;32m+        <div class="status">[0m
[0;32m[0m[0;32m+            Nginx configurado exitosamente[0m
[0;32m[0m[0;32m+        </div>[0m
[0;32m[0m[0;32m+        [0m
[0;32m[0m[0;32m+        <div class="info-grid">[0m
[0;32m[0m[0;32m+            <div class="info-card">[0m
[0;32m[0m[0;32m+                <h3>Servidor</h3>[0m
[0;32m[0m[0;32m+                <p>vamalaver01</p>[0m
[0;32m[0m[0;32m+                <p>10.0.0.5</p>[0m
[0;32m[0m[0;32m+            </div>[0m
[0;32m[0m[0;32m+            [0m
[0;32m[0m[0;32m+            <div class="info-card">[0m
[0;32m[0m[0;32m+                <h3>Sistema</h3>[0m
[0;32m[0m[0;32m+                <p>Ubuntu 24.04</p>[0m
[0;32m[0m[0;32m+                <p>x86_64</p>[0m
[0;32m[0m[0;32m+            </div>[0m
[0;32m[0m[0;32m+            [0m
[0;32m[0m[0;32m+            <div class="info-card">[0m
[0;32m[0m[0;32m+                <h3>Nginx</h3>[0m
[0;32m[0m[0;32m+                <p>Workers: 2</p>[0m
[0;32m[0m[0;32m+                <p>Conexiones: 1024</p>[0m
[0;32m[0m[0;32m+            </div>[0m
[0;32m[0m[0;32m+            [0m
[0;32m[0m[0;32m+            <div class="info-card">[0m
[0;32m[0m[0;32m+                <h3>Red</h3>[0m
[0;32m[0m[0;32m+                <p>HTTP: 80</p>[0m
[0;32m[0m[0;32m+                <p>HTTPS: 443</p>[0m
[0;32m[0m[0;32m+            </div>[0m
[0;32m[0m[0;32m+        </div>[0m
[0;32m[0m[0;32m+        [0m
[0;32m[0m[0;32m+        <div class="footer">[0m
[0;32m[0m[0;32m+            <p><strong>SFI Networks</strong></p>[0m
[0;32m[0m[0;32m+            <p>Desplegado: 2025-07-26 | Entorno: laboratorio</p>[0m
[0;32m[0m[0;32m+            <p>Administrador: aldo.malaver@runittech.com</p>[0m
[0;32m[0m[0;32m+        </div>[0m
[0;32m[0m[0;32m+    </div>[0m
[0;32m[0m[0;32m+</body>[0m
[0;32m[0m[0;32m+</html>[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m

2025-07-26 15:37:40,675 p=1441460 u=root n=ansible | changed: [web1] => (item={'name': 'default', 'server_name': '10.0.0.5', 'document_root': '/var/www/html', 'index_files': 'index.html index.htm'})
2025-07-26 15:37:41,159 p=1441460 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-1441460azm8_dpp/tmpjdqk8nni/index.html.j2[0m
[0;32m[0m[0;36m@@ -0,0 +1,111 @@[0m
[0;36m[0m[0;32m+<!DOCTYPE html>[0m
[0;32m[0m[0;32m+<html lang="es">[0m
[0;32m[0m[0;32m+<head>[0m
[0;32m[0m[0;32m+    <meta charset="UTF-8">[0m
[0;32m[0m[0;32m+    <meta name="viewport" content="width=device-width, initial-scale=1.0">[0m
[0;32m[0m[0;32m+    <title>Servidor Nginx - laboratorio</title>[0m
[0;32m[0m[0;32m+    <style>[0m
[0;32m[0m[0;32m+        body {[0m
[0;32m[0m[0;32m+            font-family: Arial, sans-serif;[0m
[0;32m[0m[0;32m+            line-height: 1.6;[0m
[0;32m[0m[0;32m+            margin: 0;[0m
[0;32m[0m[0;32m+            padding: 0;[0m
[0;32m[0m[0;32m+            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);[0m
[0;32m[0m[0;32m+            color: white;[0m
[0;32m[0m[0;32m+            min-height: 100vh;[0m
[0;32m[0m[0;32m+            display: flex;[0m
[0;32m[0m[0;32m+            align-items: center;[0m
[0;32m[0m[0;32m+            justify-content: center;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .container {[0m
[0;32m[0m[0;32m+            text-align: center;[0m
[0;32m[0m[0;32m+            background: rgba(255, 255, 255, 0.1);[0m
[0;32m[0m[0;32m+            padding: 2rem;[0m
[0;32m[0m[0;32m+            border-radius: 10px;[0m
[0;32m[0m[0;32m+            backdrop-filter: blur(10px);[0m
[0;32m[0m[0;32m+            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);[0m
[0;32m[0m[0;32m+            max-width: 600px;[0m
[0;32m[0m[0;32m+            margin: 0 auto;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        h1 {[0m
[0;32m[0m[0;32m+            font-size: 2.5rem;[0m
[0;32m[0m[0;32m+            margin-bottom: 1rem;[0m
[0;32m[0m[0;32m+            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .info-grid {[0m
[0;32m[0m[0;32m+            display: grid;[0m
[0;32m[0m[0;32m+            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));[0m
[0;32m[0m[0;32m+            gap: 1rem;[0m
[0;32m[0m[0;32m+            margin: 2rem 0;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .info-card {[0m
[0;32m[0m[0;32m+            background: rgba(255, 255, 255, 0.2);[0m
[0;32m[0m[0;32m+            padding: 1rem;[0m
[0;32m[0m[0;32m+            border-radius: 8px;[0m
[0;32m[0m[0;32m+            border: 1px solid rgba(255, 255, 255, 0.3);[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .info-card h3 {[0m
[0;32m[0m[0;32m+            margin: 0 0 0.5rem 0;[0m
[0;32m[0m[0;32m+            color: #FFD700;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .status {[0m
[0;32m[0m[0;32m+            background: #28a745;[0m
[0;32m[0m[0;32m+            color: white;[0m
[0;32m[0m[0;32m+            padding: 0.5rem 1rem;[0m
[0;32m[0m[0;32m+            border-radius: 20px;[0m
[0;32m[0m[0;32m+            display: inline-block;[0m
[0;32m[0m[0;32m+            margin: 1rem 0;[0m
[0;32m[0m[0;32m+            font-weight: bold;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+        .footer {[0m
[0;32m[0m[0;32m+            margin-top: 2rem;[0m
[0;32m[0m[0;32m+            padding-top: 1rem;[0m
[0;32m[0m[0;32m+            border-top: 1px solid rgba(255, 255, 255, 0.3);[0m
[0;32m[0m[0;32m+            font-size: 0.9rem;[0m
[0;32m[0m[0;32m+            opacity: 0.8;[0m
[0;32m[0m[0;32m+        }[0m
[0;32m[0m[0;32m+    </style>[0m
[0;32m[0m[0;32m+</head>[0m
[0;32m[0m[0;32m+<body>[0m
[0;32m[0m[0;32m+    <div class="container">[0m
[0;32m[0m[0;32m+        <h1>Servidor Nginx - laboratorio</h1>[0m
[0;32m[0m[0;32m+        [0m
[0;32m[0m[0;32m+        <div class="status">[0m
[0;32m[0m[0;32m+            Nginx configurado exitosamente[0m
[0;32m[0m[0;32m+        </div>[0m
[0;32m[0m[0;32m+        [0m
[0;32m[0m[0;32m+        <div class="info-grid">[0m
[0;32m[0m[0;32m+            <div class="info-card">[0m
[0;32m[0m[0;32m+                <h3>Servidor</h3>[0m
[0;32m[0m[0;32m+                <p>vamalaver01</p>[0m
[0;32m[0m[0;32m+                <p>10.0.0.5</p>[0m
[0;32m[0m[0;32m+            </div>[0m
[0;32m[0m[0;32m+            [0m
[0;32m[0m[0;32m+            <div class="info-card">[0m
[0;32m[0m[0;32m+                <h3>Sistema</h3>[0m
[0;32m[0m[0;32m+                <p>Ubuntu 24.04</p>[0m
[0;32m[0m[0;32m+                <p>x86_64</p>[0m
[0;32m[0m[0;32m+            </div>[0m
[0;32m[0m[0;32m+            [0m
[0;32m[0m[0;32m+            <div class="info-card">[0m
[0;32m[0m[0;32m+                <h3>Nginx</h3>[0m
[0;32m[0m[0;32m+                <p>Workers: 2</p>[0m
[0;32m[0m[0;32m+                <p>Conexiones: 1024</p>[0m
[0;32m[0m[0;32m+            </div>[0m
[0;32m[0m[0;32m+            [0m
[0;32m[0m[0;32m+            <div class="info-card">[0m
[0;32m[0m[0;32m+                <h3>Red</h3>[0m
[0;32m[0m[0;32m+                <p>HTTP: 80</p>[0m
[0;32m[0m[0;32m+                <p>HTTPS: 443</p>[0m
[0;32m[0m[0;32m+            </div>[0m
[0;32m[0m[0;32m+        </div>[0m
[0;32m[0m[0;32m+        [0m
[0;32m[0m[0;32m+        <div class="footer">[0m
[0;32m[0m[0;32m+            <p><strong>SFI Networks</strong></p>[0m
[0;32m[0m[0;32m+            <p>Desplegado: 2025-07-26 | Entorno: laboratorio</p>[0m
[0;32m[0m[0;32m+            <p>Administrador: aldo.malaver@runittech.com</p>[0m
[0;32m[0m[0;32m+        </div>[0m
[0;32m[0m[0;32m+    </div>[0m
[0;32m[0m[0;32m+</body>[0m
[0;32m[0m[0;32m+</html>[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m

2025-07-26 15:37:41,160 p=1441460 u=root n=ansible | changed: [web1] => (item={'name': 'empresa', 'server_name': 'empresa.local', 'document_root': '/var/www/empresa', 'index_files': 'index.html'})
2025-07-26 15:37:41,168 p=1441460 u=root n=ansible | TASK [Config: Configurar logrotate para nginx] *****************************************************************************************************************************
2025-07-26 15:37:41,869 p=1441460 u=root n=ansible | [0;31m--- before: /etc/logrotate.d/nginx[0m
[0;31m[0m[0;32m+++ after: /opt/nginx-lab/playbooks/files/nginx-logrotate[0m
[0;32m[0m[0;36m@@ -1,18 +1,21 @@[0m
[0;36m[0m[0;32m+# files/nginx-logrotate - Configuración para rotación de logs de nginx[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m /var/log/nginx/*.log {
[0;31m-	daily[0m
[0;31m[0m[0;31m-	missingok[0m
[0;31m[0m[0;31m-	rotate 14[0m
[0;31m[0m[0;31m-	compress[0m
[0;31m[0m[0;31m-	delaycompress[0m
[0;31m[0m[0;31m-	notifempty[0m
[0;31m[0m[0;31m-	create 0640 www-data adm[0m
[0;31m[0m[0;31m-	sharedscripts[0m
[0;31m[0m[0;31m-	prerotate[0m
[0;31m[0m[0;31m-		if [ -d /etc/logrotate.d/httpd-prerotate ]; then \[0m
[0;31m[0m[0;31m-			run-parts /etc/logrotate.d/httpd-prerotate; \[0m
[0;31m[0m[0;31m-		fi \[0m
[0;31m[0m[0;31m-	endscript[0m
[0;31m[0m[0;31m-	postrotate[0m
[0;31m[0m[0;31m-		invoke-rc.d nginx rotate >/dev/null 2>&1[0m
[0;31m[0m[0;31m-	endscript[0m
[0;31m[0m[0;32m+    daily                    [0m
[0;32m[0m[0;32m+    missingok               [0m
[0;32m[0m[0;32m+    rotate 30               [0m
[0;32m[0m[0;32m+    compress                [0m
[0;32m[0m[0;32m+    delaycompress           [0m
[0;32m[0m[0;32m+    notifempty              [0m
[0;32m[0m[0;32m+    create 0644 www-data www-data    [0m
[0;32m[0m[0;32m+    sharedscripts           [0m
[0;32m[0m[0;32m+    prerotate[0m
[0;32m[0m[0;32m+        if [ -d /etc/logrotate.d/httpd-prerotate ]; then \[0m
[0;32m[0m[0;32m+            run-parts /etc/logrotate.d/httpd-prerotate; \[0m
[0;32m[0m[0;32m+        fi \[0m
[0;32m[0m[0;32m+    endscript[0m
[0;32m[0m[0;32m+    postrotate[0m
[0;32m[0m[0;32m+        invoke-rc.d nginx rotate >/dev/null 2>&1 || true[0m
[0;32m[0m[0;32m+    endscript[0m
[0;32m[0m }
[0;32m+[0m
[0;32m[0m

2025-07-26 15:37:41,869 p=1441460 u=root n=ansible | changed: [web1]
2025-07-26 15:37:41,875 p=1441460 u=root n=ansible | TASK [Config: Crear archivos de log si no existen] *************************************************************************************************************************
2025-07-26 15:37:42,148 p=1441460 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,6 +1,6 @@[0m
[0;36m[0m {
[0;31m-    "atime": 1753488000.9889898,[0m
[0;31m[0m[0;31m-    "mtime": 1753543861.8372376,[0m
[0;31m[0m[0;32m+    "atime": 1753544262.1251895,[0m
[0;32m[0m[0;32m+    "mtime": 1753544262.1251895,[0m
[0;32m[0m     "path": "/var/log/nginx/access.log",
[0;31m-    "state": "file"[0m
[0;31m[0m[0;32m+    "state": "touch"[0m
[0;32m[0m }


2025-07-26 15:37:42,149 p=1441460 u=root n=ansible | changed: [web1] => (item=/var/log/nginx/access.log)
2025-07-26 15:37:42,367 p=1441460 u=root n=ansible | [0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,6 +1,6 @@[0m
[0;36m[0m {
[0;31m-    "atime": 1753142416.2506065,[0m
[0;31m[0m[0;31m-    "mtime": 1753142416.2506065,[0m
[0;31m[0m[0;32m+    "atime": 1753544262.3458414,[0m
[0;32m[0m[0;32m+    "mtime": 1753544262.3458414,[0m
[0;32m[0m     "path": "/var/log/nginx/error.log",
[0;31m-    "state": "file"[0m
[0;31m[0m[0;32m+    "state": "touch"[0m
[0;32m[0m }


2025-07-26 15:37:42,368 p=1441460 u=root n=ansible | changed: [web1] => (item=/var/log/nginx/error.log)
2025-07-26 15:37:42,376 p=1441460 u=root n=ansible | TASK [Config: Configurar firewall para HTTP/HTTPS] *************************************************************************************************************************
2025-07-26 15:37:42,959 p=1441460 u=root n=ansible | changed: [web1] => (item=80)
2025-07-26 15:37:43,371 p=1441460 u=root n=ansible | changed: [web1] => (item=443)
2025-07-26 15:37:43,380 p=1441460 u=root n=ansible | TASK [Verificación: Comprobar sintaxis de nginx] ***************************************************************************************************************************
2025-07-26 15:37:43,603 p=1441460 u=root n=ansible | skipping: [web1]
2025-07-26 15:37:43,609 p=1441460 u=root n=ansible | TASK [Verificación: Mostrar resultado de sintaxis] *************************************************************************************************************************
2025-07-26 15:37:43,645 p=1441460 u=root n=ansible | ok: [web1] => {
    "nginx_syntax_check.stderr_lines": []
}
2025-07-26 15:37:43,652 p=1441460 u=root n=ansible | TASK [Service: Asegurar que nginx esté iniciado y habilitado] **************************************************************************************************************
2025-07-26 15:37:44,070 p=1441460 u=root n=ansible | ok: [web1]
2025-07-26 15:37:44,085 p=1441460 u=root n=ansible | TASK [Verificación: Comprobar que nginx responde] **************************************************************************************************************************
2025-07-26 15:37:44,658 p=1441460 u=root n=ansible | skipping: [web1]
2025-07-26 15:37:44,664 p=1441460 u=root n=ansible | TASK [Info: Mostrar información de configuración] **************************************************************************************************************************
2025-07-26 15:37:44,719 p=1441460 u=root n=ansible | ok: [web1] => {
    "msg": "=====================================\nCONFIGURACIÓN COMPLETADA\n=====================================\nHost: vamalaver01\nIP: 10.0.0.5\nPuerto HTTP: 80\nPuerto HTTPS: 443\nWorkers: 2\nConexiones por worker: 1024\nVirtual Hosts configurados: 2\n=====================================\n"
}
2025-07-26 15:37:44,741 p=1441460 u=root n=ansible | RUNNING HANDLER [restart nginx] ********************************************************************************************************************************************
2025-07-26 15:37:45,153 p=1441460 u=root n=ansible | changed: [web1]
2025-07-26 15:37:45,160 p=1441460 u=root n=ansible | RUNNING HANDLER [reload nginx] *********************************************************************************************************************************************
2025-07-26 15:37:45,569 p=1441460 u=root n=ansible | changed: [web1]
2025-07-26 15:37:45,576 p=1441460 u=root n=ansible | RUNNING HANDLER [validate nginx config] ************************************************************************************************************************************
2025-07-26 15:37:45,800 p=1441460 u=root n=ansible | skipping: [web1]
2025-07-26 15:37:45,808 p=1441460 u=root n=ansible | TASK [Reporte: Mostrar resumen final] **************************************************************************************************************************************
2025-07-26 15:37:45,861 p=1441460 u=root n=ansible | ok: [web1] => {
    "msg": "=====================================\nLABORATORIO COMPLETADO\n=====================================\nInstalación: EXITOSA\nConfiguración: EXITOSA\nVerificación: EXITOSA\nServidores configurados: 1\nURLs disponibles:\n- http://10.0.0.5:80\nPróximos pasos:\n1. Acceder a las URLs para verificar\n2. Revisar logs en /var/log/nginx/\n3. Experimentar con configuraciones\n=====================================\n"
}
2025-07-26 15:37:45,873 p=1441460 u=root n=ansible | PLAY RECAP *****************************************************************************************************************************************************************
2025-07-26 15:37:45,873 p=1441460 u=root n=ansible | web1                       : ok=28   changed=14   unreachable=0    failed=0    skipped=6    rescued=0    ignored=0   
2025-07-26 15:48:45,331 p=1444190 u=root n=ansible | web1 | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
2025-07-26 16:08:51,016 p=1448834 u=root n=ansible | [WARNING]: Unhandled error in Python interpreter discovery for host web2: Failed to connect to the host via ssh: Warning: Permanently added '135.237.121.243' (ED25519) to
the list of known hosts.  amalaver@135.237.121.243: Permission denied (publickey).

2025-07-26 16:08:51,256 p=1448834 u=root n=ansible | web2 | UNREACHABLE! => {
    "changed": false,
    "msg": "Data could not be sent to remote host \"135.237.121.243\". Make sure this host can be reached over ssh: amalaver@135.237.121.243: Permission denied (publickey).\r\n",
    "unreachable": true
}
2025-07-26 16:08:51,660 p=1448834 u=root n=ansible | web1 | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
2025-07-26 16:11:43,181 p=1449512 u=root n=ansible | web1 | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
2025-07-26 16:11:43,859 p=1449512 u=root n=ansible | web2 | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
2025-07-26 16:18:41,103 p=1451072 u=root n=ansible | web2 | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
2025-07-26 16:18:41,423 p=1451072 u=root n=ansible | web1 | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
